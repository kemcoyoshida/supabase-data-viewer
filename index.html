<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Éá„Éº„Çø„Éô„Éº„ÇπÁÆ°ÁêÜ - Êó•‰∏ãÈÉ®ÈõªÊ©ü „Éá„Éº„ÇøÁÆ°ÁêÜ„Éó„É©„ÉÉ„Éà„Éï„Ç©„Éº„É†</title>
    <link rel="stylesheet" href="style.css">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Supabase JS SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- „É°„Ç§„É≥„Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ -->
    <div id="main-app" class="main-app">
    <!-- „Éò„ÉÉ„ÉÄ„Éº -->
    <header class="top-header">
        <div class="header-content">
            <h1>„Éá„Éº„Çø„Éô„Éº„ÇπÁÆ°ÁêÜ</h1>
            <div class="header-actions">
                <div class="notification-icon-wrapper">
                    <button class="header-icon-btn" id="notification-btn" title="ÈÄöÁü•">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge" id="header-notification-badge">3</span>
                    </button>
                </div>
                <button class="header-btn">Ë®≠ÂÆö</button>
            </div>
        </div>
    </header>

    <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„Éä -->
    <div class="main-container">
        <!-- Â∑¶„Çµ„Ç§„Éâ„Éê„ÉºÔºà„É°„Éã„É•„ÉºÔºâ -->
        <aside class="left-sidebar">
            <div class="sidebar-header">
                <h2>- „É°„Ç§„É≥„É°„Éã„É•„Éº -</h2>
            </div>
            <nav class="main-menu">
                <button class="menu-item active" data-page="dashboard">
                    <i class="fas fa-home"></i>
                    <span>„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ</span>
                </button>
                <button class="menu-item" data-page="list">
                    <i class="fas fa-list"></i>
                    <span>‰∏ÄË¶ßË°®Á§∫</span>
                </button>
                <button class="menu-item" data-page="register">
                    <i class="fas fa-plus-circle"></i>
                    <span>ÁôªÈå≤</span>
                </button>
                <button class="menu-item" data-page="search">
                    <i class="fas fa-search"></i>
                    <span>Ê§úÁ¥¢</span>
                </button>
                <button class="menu-item" data-page="aggregate">
                    <i class="fas fa-chart-bar"></i>
                    <span>ÈõÜË®à</span>
                </button>
            </nav>
            <div class="table-list-section">
                <h3>„ÉÜ„Éº„Éñ„É´‰∏ÄË¶ß</h3>
                <input type="text" id="table-search-input" class="table-search-input" placeholder="„ÉÜ„Éº„Éñ„É´„ÇíÊ§úÁ¥¢...">
                <div id="table-list-content" class="table-list-content">
                    <p class="loading">Ë™≠„ÅøËæº„Åø‰∏≠...</p>
                </div>
            </div>
            <div class="sidebar-footer">
                <p>„É≠„Ç∞„Ç§„É≥„É¶„Éº„Ç∂„Éº: „Ç∑„Çπ„ÉÜ„É†ÁÆ°ÁêÜËÄÖ</p>
                <p id="current-time"></p>
            </div>
        </aside>

        <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Ç®„É™„Ç¢ -->
        <main class="content-area">
            <!-- „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Éö„Éº„Ç∏ -->
            <div id="dashboard-page" class="page active">
                <!-- Êé≤Á§∫Êùø -->
                <div class="dashboard-card bulletin-card" style="margin-bottom: 20px; cursor: pointer;" onclick="showPage('bulletin')" title="„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶Êé≤Á§∫Êùø„Éö„Éº„Ç∏„ÇíÈñã„Åè">
                    <div class="section-header" onclick="event.stopPropagation();">
                        <h3>Êé≤Á§∫Êùø</h3>
                        <button class="btn-primary btn-small" id="add-bulletin-btn">
                            <i class="fas fa-plus"></i> ËøΩÂä†
                        </button>
                    </div>
                    <div class="bulletin-list" id="bulletin-list" onclick="event.stopPropagation();">
                        <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
                    </div>
                </div>

                <!-- „Ç´„É¨„É≥„ÉÄ„Éº„Å®„Çø„Çπ„ÇØ„É™„Çπ„Éà -->
                <div class="dashboard-top-row">
                    <!-- „Ç´„É¨„É≥„ÉÄ„Éº -->
                    <div class="dashboard-card calendar-card">
                        <div class="card-header-with-action">
                            <button class="calendar-nav-btn" id="calendar-prev" onclick="changeCalendarMonth(-1)">‚Äπ</button>
                            <h3 id="calendar-month-year">2024/01 January</h3>
                            <button class="calendar-nav-btn" id="calendar-next" onclick="changeCalendarMonth(1)">‚Ä∫</button>
                        </div>
                        <div class="calendar-actions">
                            <button class="calendar-jump-btn" onclick="changeCalendarYear(-1)" title="1Âπ¥Ââç">1Âπ¥Ââç</button>
                            <button class="calendar-jump-btn" onclick="changeCalendarMonths(-6)" title="6„É∂ÊúàÂâç">6„É∂ÊúàÂâç</button>
                            <button class="calendar-jump-btn" onclick="changeCalendarMonths(-3)" title="3„É∂ÊúàÂâç">3„É∂ÊúàÂâç</button>
                            <button class="calendar-today-btn" onclick="goToToday()" title="‰ªäÊó•„Å´Êàª„Çã">‰ªäÊó•</button>
                            <button class="calendar-jump-btn" onclick="changeCalendarMonths(3)" title="3„É∂ÊúàÂÖà">3„É∂ÊúàÂÖà</button>
                            <button class="calendar-jump-btn" onclick="changeCalendarMonths(6)" title="6„É∂ÊúàÂÖà">6„É∂ÊúàÂÖà</button>
                            <button class="calendar-jump-btn" onclick="changeCalendarYear(1)" title="1Âπ¥ÂÖà">1Âπ¥ÂÖà</button>
                        </div>
                        <div id="calendar-weekday-header" class="calendar-weekday-header"></div>
                        <div id="calendar-grid" class="calendar-grid"></div>
                    </div>

                    <!-- „Çø„Çπ„ÇØ„É™„Çπ„Éà -->
                    <div class="dashboard-card task-list-card">
                        <div class="section-header">
                            <h3><i class="fas fa-tasks"></i> „Çø„Çπ„ÇØ„É™„Çπ„Éà</h3>
                            <button class="btn-primary btn-small" id="add-task-btn" onclick="if(typeof window.openTaskModal === 'function') { window.openTaskModal(); } else { const m = document.getElementById('task-modal'); if(m) { m.style.display = 'flex'; m.style.zIndex = '10000'; } }">
                                <i class="fas fa-plus"></i> ËøΩÂä†
                            </button>
                        </div>
                        <div id="task-kanban-board" class="task-kanban-board">
                            <div class="kanban-column" data-status="pending">
                                <div class="kanban-column-header">
                                    <h4>Êú™ÂÆå‰∫Ü</h4>
                                    <span class="kanban-count" id="count-pending">0</span>
                                </div>
                                <div class="kanban-column-content" id="kanban-pending">
                                    <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
                                </div>
                            </div>
                            <div class="kanban-column" data-status="in-progress">
                                <div class="kanban-column-header">
                                    <h4>ÈÄ≤Ë°å‰∏≠</h4>
                                    <span class="kanban-count" id="count-in-progress">0</span>
                                </div>
                                <div class="kanban-column-content" id="kanban-in-progress">
                                    <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
                                </div>
                            </div>
                            <div class="kanban-column" data-status="completed">
                                <div class="kanban-column-header">
                                    <h4>ÂÆå‰∫Ü</h4>
                                    <span class="kanban-count" id="count-completed">0</span>
                                </div>
                                <div class="kanban-column-content" id="kanban-completed">
                                    <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

            <!-- Êé≤Á§∫Êùø„Éö„Éº„Ç∏ -->
            <div id="bulletin-page" class="page">
                <div class="page-title">
                    <h2>Êé≤Á§∫Êùø</h2>
                    <button class="btn-secondary" onclick="showPage('dashboard')">
                        <i class="fas fa-arrow-left"></i> „ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ„Å´Êàª„Çã
                    </button>
                </div>
                <div class="dashboard-card bulletin-card-full" style="margin-bottom: 20px;">
                    <div class="section-header">
                        <h3>Êé≤Á§∫Êùø</h3>
                        <button class="btn-primary btn-small" id="add-bulletin-btn-full">
                            <i class="fas fa-plus"></i> ËøΩÂä†
                        </button>
                    </div>
                    <div class="bulletin-list-full" id="bulletin-list-full">
                        <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
                    </div>
                </div>
            </div>

            <!-- ‰∏ÄË¶ßË°®Á§∫„Éö„Éº„Ç∏ -->
            <div id="list-page" class="page">
                <div class="page-title">
                    <h2 id="current-table-title">Ê©üÊ¢∞„Ç≥„Éº„ÉâÁÆ°ÁêÜ - ‰∏ÄË¶ßË°®Á§∫</h2>
                </div>

                <!-- Ê§úÁ¥¢„Éª„Éï„Ç£„É´„Çø„Éº„Çª„ÇØ„Ç∑„Éß„É≥ -->
                <div class="search-section">
                    <div class="search-field-full">
                        <label>üîç Ê§úÁ¥¢</label>
                        <div class="search-row">
                            <select id="filter-column-select" class="column-filter-select">
                                <option value="">„Åô„Åπ„Å¶„ÅÆÈ†ÖÁõÆ„ÇíÊ§úÁ¥¢</option>
                            </select>
                            <input type="text" id="filter-global-search" class="search-input" placeholder="„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„Å¶Ê§úÁ¥¢">
                    </div>
                    </div>
                    <div class="search-actions">
                        <button id="execute-search" class="btn-primary">Ê§úÁ¥¢ÂÆüË°å</button>
                        <button id="clear-search" class="btn-secondary">„ÇØ„É™„Ç¢</button>
                    </div>
                </div>

                <!-- „Éá„Éº„ÇøÊìç‰Ωú„Éú„Çø„É≥ -->
                <div class="data-actions">
                    <div class="data-actions-left">
                    <button id="new-register" class="btn-primary">Êñ∞Ë¶èÁôªÈå≤</button>
                    <button id="refresh-table" class="btn-secondary" title="„ÉÜ„Éº„Éñ„É´„Éá„Éº„Çø„ÇíÊõ¥Êñ∞">
                        <i class="fas fa-sync-alt"></i> Êõ¥Êñ∞
                    </button>
                    <button id="csv-export" class="btn-secondary">CSVÂá∫Âäõ</button>
                    <button id="csv-import" class="btn-secondary">CSV„Ç§„É≥„Éù„Éº„Éà</button>
                    <input type="file" id="csv-file-input" accept=".csv" style="display: none;">
                    </div>
                    <div class="selection-controls">
                        <span id="selection-count" class="selection-count">ÈÅ∏ÊäûÊï∞: 0</span>
                        <div class="selection-buttons">
                            <button id="select-all-btn" class="btn-selection">ÂÖ®ÈÅ∏Êäû</button>
                            <button id="deselect-all-btn" class="btn-selection">ÂÖ®Ëß£Èô§</button>
                        </div>
                    </div>
                </div>

                <!-- „Éö„Éº„Ç∏„Éç„Éº„Ç∑„Éß„É≥ÊÉÖÂ†± -->
                <div class="pagination-info">
                    <span id="page-info">1/1„Éö„Éº„Ç∏ (1-20/Ë©≤ÂΩì„É¨„Ç≥„Éº„ÉâÊï∞: 0 / ÂÖ®„É¨„Ç≥„Éº„ÉâÊï∞: 0)</span>
                    <div class="pagination-controls">
                        <button id="first-page" class="page-btn">|<</button>
                        <button id="prev-page" class="page-btn"><</button>
                        <button id="next-page" class="page-btn">></button>
                        <button id="last-page" class="page-btn">>|</button>
                    </div>
                </div>

                <!-- „Éá„Éº„Çø„ÉÜ„Éº„Éñ„É´ -->
                <div class="table-container">
                    <table id="data-table" class="data-table">
                        <thead id="table-head"></thead>
                        <tbody id="table-body"></tbody>
                    </table>
                </div>
            </div>

            <!-- ÁôªÈå≤„Éö„Éº„Ç∏ -->
            <div id="register-page" class="page">
                <div class="page-title" style="margin-bottom: 8px;">
                    <h2 style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-size: 28px; font-weight: 700; letter-spacing: 0.5px;">ÁôªÈå≤„ÉªÁ∑®ÈõÜ</h2>
                </div>
                <div class="register-buttons">
                    <button class="register-btn" data-type="work-ticket" onclick="showPage('work-ticket')">
                        <i class="fas fa-clipboard-list" style="font-size: 24px; margin-right: 12px; color: var(--primary); flex-shrink: 0;"></i>
                        <span>‰ΩúÊ•≠Á•®„ÅÆÁôªÈå≤</span>
                    </button>
                    <button class="register-btn" data-type="barcode">
                        <i class="fas fa-barcode" style="font-size: 24px; margin-right: 12px; color: var(--primary); flex-shrink: 0;"></i>
                        <span>„Éê„Éº„Ç≥„Éº„Éâ„É™„Éº„ÉÄ„ÉºÁâà<br>‰ΩúÊ•≠Á•®„ÅÆÁôªÈå≤</span>
                    </button>
                    <button class="register-btn" data-type="misc-purchase">
                        <i class="fas fa-shopping-cart" style="font-size: 24px; margin-right: 12px; color: var(--primary); flex-shrink: 0;"></i>
                        <span>Ë´∏ÊéõË≥ºÂÖ•ÁôªÈå≤</span>
                    </button>
                    <button class="register-btn" data-type="misc-delivery">
                        <i class="fas fa-truck" style="font-size: 24px; margin-right: 12px; color: var(--primary); flex-shrink: 0;"></i>
                        <span>Ë´∏ÊéõÁ¥çÂÖ•Âá¶ÁêÜ</span>
                    </button>
                    <button class="register-btn" data-type="delivery-approval">
                        <i class="fas fa-check-circle" style="font-size: 24px; margin-right: 12px; color: var(--primary); flex-shrink: 0;"></i>
                        <span>Á¥çÊúüÊâøË™ç</span>
                    </button>
                    <button class="register-btn" data-type="shipping">
                        <i class="fas fa-shipping-fast" style="font-size: 24px; margin-right: 12px; color: var(--primary); flex-shrink: 0;"></i>
                        <span>Âá∫Ëç∑ÁÆ°ÁêÜ</span>
                    </button>
                    <button class="register-btn" data-type="outsource-delivery">
                        <i class="fas fa-handshake" style="font-size: 24px; margin-right: 12px; color: var(--primary); flex-shrink: 0;"></i>
                        <span>Â§ñÊ≥®„ÉªÊùêÊñô<br>Á¥çÂÖ•Âá¶ÁêÜ</span>
                    </button>
                    <button class="register-btn" data-type="parts-delivery">
                        <i class="fas fa-cogs" style="font-size: 24px; margin-right: 12px; color: var(--primary); flex-shrink: 0;"></i>
                        <span>Ë≥ºÂÖ•ÈÉ®ÂìÅ<br>Á¥çÂÖ•Âá¶ÁêÜ</span>
                    </button>
                    <button class="register-btn" data-type="surplus-register">
                        <i class="fas fa-box" style="font-size: 24px; margin-right: 12px; color: var(--primary); flex-shrink: 0;"></i>
                        <span>‰Ωô„ÇäÂìÅÁôªÈå≤</span>
                    </button>
                    <button class="register-btn" data-type="surplus-search">
                        <i class="fas fa-search" style="font-size: 24px; margin-right: 12px; color: var(--primary); flex-shrink: 0;"></i>
                        <span>‰Ωô„ÇäÂìÅÊ§úÁ¥¢</span>
                    </button>
                    <button class="register-btn" data-type="project-shipping">
                        <i class="fas fa-file-export" style="font-size: 24px; margin-right: 12px; color: var(--primary); flex-shrink: 0;"></i>
                        <span>Â∑•‰∫ãÁï™Âè∑Âá∫Ëç∑ÁôªÈå≤</span>
                    </button>
                    <button class="register-btn" data-type="budget">
                        <i class="fas fa-yen-sign" style="font-size: 24px; margin-right: 12px; color: var(--primary); flex-shrink: 0;"></i>
                        <span>ÈÉ®ÂìÅÂçò‰Ωç‰∫àÁÆóÁôªÈå≤</span>
                    </button>
                    <button class="register-btn" data-type="construct-number" onclick="showPage('construct-number');">
                        <i class="fas fa-hashtag" style="font-size: 24px; margin-right: 12px; color: var(--primary); flex-shrink: 0;"></i>
                        <span>Â∑•‰∫ãÁï™Âè∑Êé°Áï™</span>
                    </button>
                    <button class="register-btn" data-type="drawing-number" onclick="showPage('drawing-number');">
                        <i class="fas fa-drafting-compass" style="font-size: 24px; margin-right: 12px; color: var(--primary); flex-shrink: 0;"></i>
                        <span>Âõ≥Èù¢Áï™Âè∑Êé°Áï™</span>
                    </button>
                </div>
            </div>

            <!-- ‰ΩúÊ•≠Á•®ÁôªÈå≤„Éö„Éº„Ç∏ -->
            <div id="work-ticket-page" class="page">
                <div id="work-ticket-page-content" style="padding: 24px; height: 100%; overflow-y: auto;">
                    <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
                </div>
            </div>

            <!-- Â∑•‰∫ãÁï™Âè∑Êé°Áï™„Éö„Éº„Ç∏ -->
            <div id="construct-number-page" class="page">
                <div class="page-title" style="flex-shrink: 0;">
                    <h2>Â∑•‰∫ãÁï™Âè∑Êé°Áï™„Ç∑„Çπ„ÉÜ„É†</h2>
                </div>
                <div style="padding: 24px; flex: 1; overflow: hidden; min-height: 0; display: flex; flex-direction: column; justify-content: flex-start; align-items: center;">
                    <div style="display: flex; gap: 24px; align-items: flex-start; flex: 1; min-height: 0; max-width: calc(100vw - 600px); width: calc(100vw - 600px); justify-content: center; margin-left: 2cm;">
                        <!-- Â∑¶ÂÅ¥ÔºöÂÖ•Âäõ„Éï„Ç©„Éº„É† -->
                        <div style="flex: 0 0 420px; max-width: 420px; min-width: 380px; display: flex; flex-direction: column;">
                            <div style="background: linear-gradient(135deg, rgba(74, 144, 226, 0.05) 0%, rgba(74, 144, 226, 0.02) 100%); border-radius: 16px; padding: 20px; border: 2px solid rgba(74, 144, 226, 0.1); display: flex; flex-direction: column;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px; flex-shrink: 0; justify-content: center;">
                                    <h4 style="margin: 0; font-size: 16px; font-weight: 700; color: var(--text-primary);">Êñ∞Ë¶èÂ∑•‰∫ãÁï™Âè∑ÂèñÂæó</h4>
                                </div>
                                <form id="construct-number-form-page" class="register-form" onsubmit="event.preventDefault(); if(typeof getConstructNumberPage === 'function') { getConstructNumberPage(); } return false;" style="display: flex; flex-direction: column; flex: 1; min-height: 0;">
                                    <div style="flex: 1; display: flex; flex-direction: column; min-height: 0;">
                                        <div class="form-field form-field-full" style="flex-shrink: 0;">
                                            <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px; justify-content: center;">
                                                Â∑•‰∫ãÁï™Âè∑Âè∞ <span class="required">*</span>
                                            </label>
                                            <select id="construct-number-select-page" name="Â∑•‰∫ãÁï™Âè∑Âè∞" class="form-input" required style="font-size: 14px; padding: 12px;">
                                                <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                                                <optgroup label="1000Áï™Âè∞Á≥ª">
                                                    <option value="1000Áï™Âè∞">1000Áï™Âè∞</option>
                                                </optgroup>
                                                <optgroup label="2000Áï™Âè∞Á≥ª">
                                                    <option value="2000Áï™Âè∞">2000Áï™Âè∞</option>
                                                    <option value="2900Áï™Âè∞">2900Áï™Âè∞</option>
                                                </optgroup>
                                                <optgroup label="3000Áï™Âè∞Á≥ª">
                                                    <option value="3000Áï™Âè∞">3000Áï™Âè∞</option>
                                                    <option value="3A00Áï™Âè∞">3A00Áï™Âè∞</option>
                                                    <option value="3B00Áï™Âè∞">3B00Áï™Âè∞</option>
                                                    <option value="3C00Áï™Âè∞">3C00Áï™Âè∞</option>
                                                    <option value="3P00Áï™Âè∞">3P00Áï™Âè∞</option>
                                                    <option value="3T00Áï™Âè∞">3T00Áï™Âè∞</option>
                                                </optgroup>
                                                <optgroup label="4000Áï™Âè∞Á≥ª">
                                                    <option value="4000Áï™Âè∞">4000Áï™Âè∞</option>
                                                    <option value="4A00Áï™Âè∞">4A00Áï™Âè∞</option>
                                                    <option value="4B00Áï™Âè∞">4B00Áï™Âè∞</option>
                                                    <option value="4C00Áï™Âè∞">4C00Áï™Âè∞</option>
                                                    <option value="4P00Áï™Âè∞">4P00Áï™Âè∞</option>
                                                    <option value="4T00Áï™Âè∞">4T00Áï™Âè∞</option>
                                                </optgroup>
                                                <optgroup label="5000Áï™Âè∞Á≥ª">
                                                    <option value="5000Áï™Âè∞">5000Áï™Âè∞</option>
                                                    <option value="5A00Áï™Âè∞">5A00Áï™Âè∞</option>
                                                    <option value="5B00Áï™Âè∞">5B00Áï™Âè∞</option>
                                                    <option value="5E00Áï™Âè∞">5E00Áï™Âè∞</option>
                                                </optgroup>
                                                <optgroup label="6000Áï™Âè∞Á≥ª">
                                                    <option value="6000Áï™Âè∞">6000Áï™Âè∞</option>
                                                </optgroup>
                                                <optgroup label="7000Áï™Âè∞Á≥ª">
                                                    <option value="7000Áï™Âè∞">7000Áï™Âè∞</option>
                                                    <option value="7P00Áï™Âè∞">7P00Áï™Âè∞</option>
                                                </optgroup>
                                                <optgroup label="8000Áï™Âè∞Á≥ª">
                                                    <option value="8000Áï™Âè∞">8000Áï™Âè∞</option>
                                                    <option value="8A00Áï™Âè∞">8A00Áï™Âè∞</option>
                                                    <option value="8B00Áï™Âè∞">8B00Áï™Âè∞</option>
                                                    <option value="8E00Áï™Âè∞">8E00Áï™Âè∞</option>
                                                </optgroup>
                                                <optgroup label="9000Áï™Âè∞Á≥ª">
                                                    <option value="9000Áï™Âè∞">9000Áï™Âè∞</option>
                                                </optgroup>
                                                <optgroup label="„Åù„ÅÆ‰ªñ">
                                                    <option value="S000Áï™Âè∞">S000Áï™Âè∞</option>
                                                    <option value="Z000Áï™Âè∞">Z000Áï™Âè∞</option>
                                                    <option value="D000Áï™Âè∞">D000Áï™Âè∞</option>
                                                </optgroup>
                                            </select>
                                        </div>
                                        <div class="form-field form-field-full" style="margin-top: 20px; flex-shrink: 0;">
                                            <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px; justify-content: center;">
                                                ÂèñÂæó„Åï„Çå„ÅüÂ∑•‰∫ãÁï™Âè∑
                                            </label>
                                            <div style="position: relative;">
                                                <input type="text" id="construct-number-result-page" class="form-input" readonly style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); font-weight: 700; font-size: 24px; text-align: center; padding: 16px; border: 3px solid var(--success); border-radius: 12px; letter-spacing: 2px; color: #2e7d32; word-break: break-all;">
                                                <div style="position: absolute; top: 8px; right: 12px; color: var(--success); font-size: 18px; opacity: 0.6;">
                                                    <i class="fas fa-copy" id="copy-construct-number-page" style="cursor: pointer;" onclick="copyConstructNumberPage()" title="„Ç≥„Éî„Éº"></i>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-actions" style="margin-top: 20px; gap: 10px; display: flex; flex-direction: column; flex-shrink: 0;">
                                            <div style="display: flex; gap: 10px; justify-content: center;">
                                                <button type="submit" class="btn-primary" style="flex: 1; min-width: 140px; max-width: 300px; font-size: 13px; padding: 10px; white-space: nowrap;">
                                                    <i class="fas fa-magic"></i> Â∑•‰∫ãÁï™Âè∑ÂèñÂæó
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <!-- Âè≥ÂÅ¥Ôºö‰ΩøÁî®Ê∏à„Åø‰∏ÄË¶ß -->
                        <div style="flex: 0 0 300px; max-width: 300px; min-width: 250px; display: flex; flex-direction: column; max-height: 100%;">
                            <div style="background: white; border-radius: 16px; padding: 20px; border: 2px solid var(--border-light); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); display: flex; flex-direction: column; max-height: 100%; overflow: hidden;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; flex-wrap: wrap; gap: 8px; flex-shrink: 0; position: relative;">
                                    <div style="flex: 1; display: flex; justify-content: center;">
                                        <h4 style="margin: 0; font-size: 16px; font-weight: 700; color: var(--text-primary);">ÈÅãÁî®‰∏≠Â∑•‰∫ãÁï™Âè∑‰∏ÄË¶ß</h4>
                                    </div>
                                    <div style="display: flex; gap: 6px; flex-wrap: wrap; align-items: center;">
                                        <button type="button" class="btn-secondary btn-small" id="import-csv-btn-page" onclick="importUsedConstructNumbersCSV()" style="padding: 6px 10px; font-size: 11px; white-space: nowrap;">
                                            <i class="fas fa-file-import"></i> CSV„Ç§„É≥„Éù„Éº„Éà
                                        </button>
                                        <button type="button" class="btn-secondary btn-small" onclick="exportUsedConstructNumbers()" style="padding: 6px 10px; font-size: 11px; white-space: nowrap;">
                                            <i class="fas fa-file-export"></i> CSVÂá∫Âäõ
                                        </button>
                                        <button type="button" class="btn-secondary btn-small" id="edit-all-used-btn-page" onclick="editAllUsedConstructNumbers()" style="padding: 6px 10px; font-size: 11px; white-space: nowrap;" title="‰∏ÄÊã¨Á∑®ÈõÜ">
                                            <i class="fas fa-cog"></i>
                                        </button>
                                    </div>
                                </div>
                                <div style="flex: 1; overflow-y: auto; overflow-x: auto; background: #fafafa; border-radius: 12px; border: 1px solid var(--border-light); min-height: 0; max-height: calc(100vh - 300px);">
                                    <table style="width: 100%; border-collapse: collapse; min-width: 200px; margin: 0 auto;">
                                        <thead style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); position: sticky; top: 0; z-index: 10;">
                                            <tr>
                                                <th style="padding: 8px 10px; text-align: center; color: white; font-size: 11px; font-weight: 600; border-bottom: 2px solid rgba(255, 255, 255, 0.2); white-space: nowrap;">
                                                    Â∑•‰∫ãÁï™Âè∑
                                                </th>
                                                <th style="padding: 8px 10px; text-align: center; color: white; font-size: 11px; font-weight: 600; border-bottom: 2px solid rgba(255, 255, 255, 0.2); white-space: nowrap;">
                                                    Êó•‰ªò
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody id="used-construct-numbers-list-page">
                                            <tr>
                                                <td colspan="3" style="text-align: center; padding: 40px; color: var(--text-tertiary);">
                                                    <i class="fas fa-inbox" style="font-size: 32px; margin-bottom: 12px; opacity: 0.3; display: block;"></i>
                                                    <span style="font-size: 13px;">ÈÅãÁî®‰∏≠Â∑•‰∫ãÁï™Âè∑„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Âõ≥Èù¢Áï™Âè∑Êé°Áï™„Éö„Éº„Ç∏ -->
            <div id="drawing-number-page" class="page">
                <div class="page-title" style="flex-shrink: 0;">
                    <h2>Âõ≥Èù¢Áï™Âè∑Êé°Áï™„Ç∑„Çπ„ÉÜ„É†</h2>
                </div>
                <div style="padding: 24px; flex: 1; overflow: hidden; min-height: 0; display: flex; flex-direction: column; justify-content: flex-start; align-items: center;">
                    <div style="display: flex; gap: 24px; align-items: flex-start; flex: 1; min-height: 0; max-width: calc(100vw - 600px); width: calc(100vw - 600px); justify-content: center; margin-left: 2cm;">
                        <!-- Â∑¶ÂÅ¥ÔºöÂÖ•Âäõ„Éï„Ç©„Éº„É† -->
                        <div style="flex: 0 0 500px; max-width: 500px; min-width: 450px; display: flex; flex-direction: column;">
                            <div style="background: linear-gradient(135deg, rgba(74, 144, 226, 0.05) 0%, rgba(74, 144, 226, 0.02) 100%); border-radius: 16px; padding: 20px; border: 2px solid rgba(74, 144, 226, 0.1); display: flex; flex-direction: column;">
                                <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px; flex-shrink: 0; justify-content: center;">
                                    <h4 style="margin: 0; font-size: 16px; font-weight: 700; color: var(--text-primary);">Âõ≥Èù¢Áï™Âè∑Êé°Áï™</h4>
                                </div>
                                <form id="drawing-number-form-page" class="register-form" onsubmit="event.preventDefault(); if(typeof getDrawingNumberPage === 'function') { getDrawingNumberPage(); } return false;" style="display: flex; flex-direction: column; flex: 1; min-height: 0; overflow-y: auto;">
                                    <div style="flex: 1; display: flex; flex-direction: column; min-height: 0; gap: 16px;">
                                        <!-- 1Ë°åÁõÆÔºöÂõ≥Èù¢Á®ÆÈ°û„Å®Ê©üÁ®ÆË®òÂè∑ -->
                                        <div style="display: flex; gap: 12px; flex-shrink: 0;">
                                            <!-- Âõ≥Èù¢Á®ÆÈ°ûÈÅ∏Êäû -->
                                            <div class="form-field" style="flex: 1; flex-shrink: 0;">
                                                <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                                    Âõ≥Èù¢Á®ÆÈ°û <span class="required">*</span>
                                                </label>
                                                <select id="drawing-type-select" class="form-input" required style="font-size: 14px; padding: 12px;">
                                                    <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                                                    <option value="parts">ÈÉ®ÂìÅÂõ≥</option>
                                                    <option value="unit">ÁµÑÂõ≥/„É¶„Éã„ÉÉ„ÉàÂõ≥</option>
                                                </select>
                                            </div>
                                            
                                            <!-- Ê©üÁ®ÆË®òÂè∑ -->
                                            <div class="form-field" style="flex: 1; flex-shrink: 0;">
                                                <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                                    Ê©üÁ®ÆË®òÂè∑ <span class="required">*</span>
                                                </label>
                                                <input type="text" id="machine-code-input" class="form-input" required 
                                                       placeholder="Ê©üÁ®ÆË®òÂè∑„ÇíÂÖ•Âäõ" 
                                                       style="text-transform: uppercase; font-size: 14px; padding: 12px;"
                                                       oninput="this.value = this.value.toUpperCase();">
                                            </div>
                                        </div>
                                        
                                        <!-- 2Ë°åÁõÆÔºöÂ∑•‰∫ãÁï™Âè∑„Å®Êé°Áï™ËÄÖ -->
                                        <div style="display: flex; gap: 12px; flex-shrink: 0;">
                                            <!-- Â∑•‰∫ãÁï™Âè∑ -->
                                            <div class="form-field" style="flex: 1; flex-shrink: 0;">
                                                <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                                    Â∑•‰∫ãÁï™Âè∑ <span class="required">*</span>
                                                </label>
                                                <input type="text" id="order-no-input" class="form-input" required 
                                                       placeholder="Â∑•‰∫ãÁï™Âè∑„ÇíÂÖ•Âäõ" 
                                                       style="text-transform: uppercase; font-size: 14px; padding: 12px;"
                                                       oninput="this.value = this.value.toUpperCase();">
                                            </div>
                                            
                                            <!-- Êé°Áï™ËÄÖ -->
                                            <div class="form-field" style="flex: 1; flex-shrink: 0;">
                                                <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                                    Êé°Áï™ËÄÖ <span class="required">*</span>
                                                </label>
                                                <select id="designer-select" class="form-input" required style="font-size: 14px; padding: 12px;">
                                                    <option value="">Ë™≠„ÅøËæº„Åø‰∏≠...</option>
                                                </select>
                                            </div>
                                        </div>
                                        
                                        <!-- 3Ë°åÁõÆÔºöÊé°Áï™Êó•„Å®Êé°Áï™ÊûöÊï∞ -->
                                        <div style="display: flex; gap: 12px; flex-shrink: 0;">
                                            <!-- Êé°Áï™Êó• -->
                                            <div class="form-field" style="flex: 1; flex-shrink: 0;">
                                                <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                                    Êé°Áï™Êó• <span class="required">*</span>
                                                </label>
                                                <input type="datetime-local" id="saiban-date-input" class="form-input" required style="font-size: 14px; padding: 12px;">
                                            </div>
                                            
                                            <!-- Êé°Áï™ÊûöÊï∞ -->
                                            <div class="form-field" style="flex: 1; flex-shrink: 0;">
                                                <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                                    Êé°Áï™ÊûöÊï∞
                                                </label>
                                                <input type="number" id="drawing-count-input" class="form-input" 
                                                       min="1" max="100" value="1" 
                                                       style="font-size: 14px; padding: 12px;">
                                            </div>
                                        </div>
                                        
                                        <!-- Âü∫Ê∫ñÂõ≥Èù¢Áï™Âè∑ -->
                                        <div class="form-field form-field-full" style="flex-shrink: 0;">
                                            <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                                Âü∫Ê∫ñÂõ≥Èù¢Áï™Âè∑ <span style="color: var(--text-secondary); font-weight: normal;">ÔºàÊú™ÂÖ•ÂäõÊôÇ„ÅØËá™ÂãïÁîüÊàêÔºâ</span>
                                            </label>
                                            <div style="display: flex; gap: 8px;">
                                                <input type="text" id="base-drawing-no-input" class="form-input" 
                                                       placeholder="10Ê°Å‰ª•‰∏ä„ÅÆÂõ≥Èù¢Áï™Âè∑„ÇíÂÖ•ÂäõÔºàÊú™ÂÖ•ÂäõÊôÇ„ÅØËá™ÂãïÁîüÊàêÔºâ" 
                                                       minlength="10"
                                                       style="font-family: monospace; font-size: 16px; letter-spacing: 2px; padding: 12px; flex: 1;">
                                                <button type="button" class="btn-secondary" onclick="generateFirstDrawingNumber()" style="white-space: nowrap; padding: 12px 16px; font-size: 13px;">
                                                    <i class="fas fa-magic"></i> Ëá™ÂãïÁîüÊàê
                                                </button>
                                            </div>
                                            <small style="display: block; margin-top: 4px; font-size: 12px; color: var(--text-secondary);">10Ê°Å‰ª•‰∏ä„ÄÅ6Ê°ÅÁõÆ„Å´„ÄåI„Äç„ÄåO„Äç„ÅØ‰ΩøÁî®‰∏çÂèØ„ÄÇÊú™ÂÖ•ÂäõÊôÇ„ÅØÊ©üÁ®ÆË®òÂè∑„Å®Âõ≥Èù¢Á®ÆÈ°û„Åã„ÇâËá™ÂãïÁîüÊàê„Åï„Çå„Åæ„Åô„ÄÇ</small>
                                        </div>
                                        
                                        <!-- ÂìÅÂêç -->
                                        <div class="form-field form-field-full" style="flex-shrink: 0;">
                                            <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                                ÂìÅÂêç
                                            </label>
                                            <input type="text" id="description-input" class="form-input" 
                                                   placeholder="ÂìÅÂêç„ÇíÂÖ•Âäõ"
                                                   style="font-size: 14px; padding: 12px;">
                                        </div>
                                        
                                        <!-- ÂèñÂæó„Åï„Çå„ÅüÂõ≥Èù¢Áï™Âè∑ -->
                                        <div class="form-field form-field-full" style="margin-top: 20px; flex-shrink: 0;">
                                            <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px; justify-content: center;">
                                                ÂèñÂæó„Åï„Çå„ÅüÂõ≥Èù¢Áï™Âè∑
                                            </label>
                                            <div style="position: relative;">
                                                <input type="text" id="drawing-number-result-page" class="form-input" readonly style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); font-weight: 700; font-size: 20px; text-align: center; padding: 16px; border: 3px solid var(--success); border-radius: 12px; letter-spacing: 2px; color: #2e7d32; word-break: break-all;">
                                                <div style="position: absolute; top: 8px; right: 12px; color: var(--success); font-size: 18px; opacity: 0.6;">
                                                    <i class="fas fa-copy" id="copy-drawing-number-page" style="cursor: pointer;" onclick="copyDrawingNumberPage()" title="„Ç≥„Éî„Éº"></i>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- „Ç®„É©„Éº„É°„ÉÉ„Çª„Éº„Ç∏ -->
                                        <div id="drawing-number-errors-page" style="display: none; background: rgba(255, 107, 107, 0.1); border: 2px solid var(--error); border-radius: 8px; padding: 12px; color: var(--error); font-size: 13px;">
                                            <i class="fas fa-exclamation-triangle" style="margin-right: 8px;"></i>
                                            <span id="drawing-number-error-message-page"></span>
                                        </div>
                                        
                                        <!-- ÊàêÂäü„É°„ÉÉ„Çª„Éº„Ç∏ -->
                                        <div id="drawing-number-success-page" style="display: none; background: rgba(78, 205, 196, 0.1); border: 2px solid var(--success); border-radius: 8px; padding: 12px; color: var(--success); font-size: 13px;">
                                            <i class="fas fa-check-circle" style="margin-right: 8px;"></i>
                                            <span id="drawing-number-success-message-page"></span>
                                        </div>
                                        
                                        <div class="form-actions" style="margin-top: 20px; gap: 10px; display: flex; flex-direction: column; flex-shrink: 0;">
                                            <div style="display: flex; gap: 10px; justify-content: center;">
                                                <button type="submit" class="btn-primary" style="flex: 1; min-width: 140px; max-width: 300px; font-size: 13px; padding: 10px; white-space: nowrap;">
                                                    <i class="fas fa-magic"></i> Âõ≥Èù¢Áï™Âè∑ÂèñÂæó
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <!-- Âè≥ÂÅ¥ÔºöÂõ≥Èù¢‰∏ÄË¶ß -->
                        <div style="flex: 0 0 400px; max-width: 400px; min-width: 350px; display: flex; flex-direction: column; max-height: 100%;">
                            <div style="background: white; border-radius: 16px; padding: 20px; border: 2px solid var(--border-light); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); display: flex; flex-direction: column; max-height: 100%; overflow: hidden;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; flex-wrap: wrap; gap: 8px; flex-shrink: 0;">
                                    <div style="display: flex; align-items: center; gap: 6px; margin: 0 auto;">
                                        <h4 style="margin: 0; font-size: 16px; font-weight: 700; color: var(--text-primary);">Âõ≥Èù¢‰∏ÄË¶ß</h4>
                                    </div>
                                    <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                        <button type="button" class="btn-secondary btn-small" id="refresh-drawing-list-btn" onclick="loadDrawingList()" style="padding: 6px 10px; font-size: 11px; white-space: nowrap;">
                                            <i class="fas fa-sync-alt"></i> Êõ¥Êñ∞
                                        </button>
                                    </div>
                                </div>
                                <div style="flex: 1; overflow-y: auto; overflow-x: auto; background: #fafafa; border-radius: 12px; border: 1px solid var(--border-light); min-height: 0; max-height: calc(100vh - 300px);">
                                    <table style="width: 100%; border-collapse: collapse; min-width: 300px; margin: 0 auto;">
                                        <thead style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); position: sticky; top: 0; z-index: 10;">
                                            <tr>
                                                <th style="padding: 8px 10px; text-align: center; color: white; font-size: 11px; font-weight: 600; border-bottom: 2px solid rgba(255, 255, 255, 0.2); white-space: nowrap;">
                                                    Âõ≥Èù¢Áï™Âè∑
                                                </th>
                                                <th style="padding: 8px 10px; text-align: center; color: white; font-size: 11px; font-weight: 600; border-bottom: 2px solid rgba(255, 255, 255, 0.2); white-space: nowrap;">
                                                    ÂìÅÂêç
                                                </th>
                                                <th style="padding: 8px 10px; text-align: center; color: white; font-size: 11px; font-weight: 600; border-bottom: 2px solid rgba(255, 255, 255, 0.2); white-space: nowrap;">
                                                    Êé°Áï™Êó•
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody id="drawing-list-page">
                                            <tr>
                                                <td colspan="3" style="text-align: center; padding: 40px; color: var(--text-tertiary);">
                                                    <i class="fas fa-inbox" style="font-size: 32px; margin-bottom: 12px; opacity: 0.3; display: block;"></i>
                                                    <span style="font-size: 13px;">Âõ≥Èù¢„Éá„Éº„Çø„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ê§úÁ¥¢„Éö„Éº„Ç∏ -->
            <div id="search-page" class="page">
                <div class="page-title">
                    <h2>Ê§úÁ¥¢</h2>
                </div>
                <div class="search-buttons">
                    <button class="search-btn">Ë≥ºÂÖ•ÈÉ®ÂìÅ„ÉªÊùêÊñô„ÉªË´∏ÁµåË≤ªÊ§úÁ¥¢</button>
                    <button class="search-btn">Â§ñÊ≥®Âä†Â∑•Ê§úÁ¥¢</button>
                    <button class="search-btn">Ê•≠ËÄÖÂà•Áô∫Ê≥®Ê∏à„ÅøÂ§ñÊ≥®Âä†Â∑•</button>
                    <button class="search-btn">Á¥çÂÖ•‰∫àÂÆö„Ç´„É¨„É≥„ÉÄ„Éº</button>
                    <button class="search-btn">Âä†Â∑•ÈÄ≤ÊçóÊ§úÁ¥¢</button>
                    <button class="search-btn">Ê©üÊ¢∞„ÅßÊ§úÁ¥¢ Âä†Â∑•ÈÄ≤Êçó</button>
                    <button class="search-btn">ÂêçÁß∞„Å´„Çà„ÇãÂéü‰æ°Ê§úÁ¥¢</button>
                    <button class="search-btn">Âá∫Âõ≥„ÉªÊâãÈÖçÁä∂Ê≥Å</button>
                    <button class="search-btn">Âä†Â∑•ÊåØ„ÇäÂàÜ„ÅëÁä∂Ê≥Å</button>
                    <button class="search-btn">Â£≤‰∏äÂπ¥Êúà„ÅßÊ§úÁ¥¢ Â∑•‰∫ã‰∏ÄË¶ß</button>
                </div>
            </div>

            <!-- ÈõÜË®à„Éö„Éº„Ç∏ -->
            <div id="aggregate-page" class="page">
                <div class="page-title">
                    <h2>ÈõÜË®à</h2>
                </div>
                <div class="aggregate-buttons">
                    <button class="aggregate-btn">Â∑•‰∫ãÁï™Âè∑„Å´„Çà„ÇãÂéü‰æ°ÈõÜË®à</button>
                    <button class="aggregate-btn">Âõ≥Èù¢Áï™Âè∑„Å´„Çà„ÇãÂéü‰æ°ÈõÜË®à</button>
                    <button class="aggregate-btn">Ê©üÊ¢∞„Åã„ÇâÂ∑•‰∫ãÁï™Âè∑Ê§úÁ¥¢</button>
                    <button class="aggregate-btn">Â∑•‰∫ãÁï™Âè∑„ÅßÊ§úÁ¥¢„Åô„Çã ÈÉ®ÂìÅ„Åî„Å®„ÅÆÂéü‰æ°ÈõÜË®à</button>
                    <button class="aggregate-btn">Ê•≠ËÄÖÂà•Ë©≤ÂΩìÊúà Á¥çÊúü„Å®Á¥çÂÖ•‰ª∂Êï∞</button>
                </div>
            </div>
        </main>

        <!-- Âè≥„Çµ„Ç§„Éâ„Éê„Éº -->
        <aside class="right-sidebar">
            <div class="right-sidebar-section">
                <h3>Áä∂ÊÖã</h3>
                <div class="status-box pending">
                    <span class="status-box-label">üìã Êú™ÂÆå‰∫Ü</span>
                    <span class="status-box-count" id="status-pending">0</span>
                </div>
                <div class="status-box in-progress">
                    <span class="status-box-label">üîÑ ÈÄ≤Ë°å‰∏≠</span>
                    <span class="status-box-count" id="status-in-progress">0</span>
                </div>
                <div class="status-box completed">
                    <span class="status-box-label">‚úÖ ÂÆå‰∫Ü</span>
                    <span class="status-box-count" id="status-completed">0</span>
                </div>
            </div>
            
            <div class="right-sidebar-section">
                <h3>üìÖ ‰ªäÊó•„ÅÆ‰∫àÂÆö</h3>
                <div id="today-events-list" class="sidebar-events-list">
                    <div class="sidebar-empty">‰∫àÂÆö„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                </div>
                <button id="add-today-event-btn" class="btn-primary btn-small" style="width: 100%; margin-top: 8px;">
                    <i class="fas fa-plus"></i> ‰∫àÂÆö„ÇíËøΩÂä†
                </button>
            </div>
            
            <div class="right-sidebar-section">
                <h3>‚è∞ ÊúüÈôê„ÅÆ„Çø„Çπ„ÇØ</h3>
                <div id="due-tasks-list" class="sidebar-tasks-list">
                    <div class="sidebar-empty">ÊúüÈôê„ÅÆ„Çø„Çπ„ÇØ„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                </div>
            </div>
        </aside>

    </div>

    <!-- „É°„ÉÉ„Çª„Éº„Ç∏Ë°®Á§∫„Ç®„É™„Ç¢ -->
    <div id="message-area"></div>

    <!-- Ë©≥Á¥∞Ë°®Á§∫„É¢„Éº„ÉÄ„É´ -->
    <div id="detail-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="detail-modal-title">Ë©≥Á¥∞</h3>
                <button class="modal-close" id="detail-modal-close">&times;</button>
            </div>
            <div class="modal-body register-modal-body">
                <div id="detail-modal-content" class="form-fields"></div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="close-detail-modal">Èñâ„Åò„Çã</button>
                    <button type="button" class="btn-primary" id="edit-from-detail-modal">Á∑®ÈõÜ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Á¢∫Ë™ç„ÉÄ„Ç§„Ç¢„É≠„Ç∞„É¢„Éº„ÉÄ„É´ -->
    <div id="confirm-dialog-modal" class="modal-overlay" style="display: none; z-index: 50000 !important;">
        <div class="modal-container" style="max-width: 500px; border-radius: 20px; background: white; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); position: relative; z-index: 50001 !important;">
            <div class="modal-body" style="padding: 40px; text-align: center;">
                <div style="font-size: 48px; margin-bottom: 20px;">‚ö†Ô∏è</div>
                <h3 id="confirm-dialog-title" style="font-size: 20px; font-weight: 700; color: var(--text-primary); margin-bottom: 16px; line-height: 1.4;"></h3>
                <p id="confirm-dialog-message" style="font-size: 15px; color: var(--text-secondary); margin-bottom: 32px; line-height: 1.6;"></p>
                <div style="display: flex; gap: 12px; justify-content: center;">
                    <button type="button" id="confirm-dialog-cancel" class="btn-secondary" style="min-width: 120px; padding: 12px 24px; font-size: 15px; font-weight: 600;">„Ç≠„É£„É≥„Çª„É´</button>
                    <button type="button" id="confirm-dialog-ok" class="btn-primary" style="min-width: 120px; padding: 12px 24px; font-size: 15px; font-weight: 600;"></button>
                </div>
            </div>
        </div>
    </div>

    <!-- ÁôªÈå≤„ÉªÁ∑®ÈõÜ„É¢„Éº„ÉÄ„É´Ôºà‰∏≠Â§ÆË°®Á§∫Ôºâ -->
    <div id="register-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="modal-title">Êñ∞Ë¶èÁôªÈå≤</h3>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>
            <div class="modal-body register-modal-body">
                <form id="register-form" class="register-form" novalidate>
                    <div id="register-form-fields" class="form-fields"></div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" id="cancel-register">„Ç≠„É£„É≥„Çª„É´</button>
                        <button type="submit" class="btn-primary">ÁôªÈå≤</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <!-- „Çø„Çπ„ÇØÁôªÈå≤„ÉªÁ∑®ÈõÜ„É¢„Éº„ÉÄ„É´ -->
    <div id="task-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="task-modal-title">Êñ∞„Åó„ÅÑ„Çø„Çπ„ÇØ„ÇíËøΩÂä†</h3>
                <button class="modal-close" onclick="if(typeof window.closeTaskModal === 'function') { window.closeTaskModal(); } else { const modal = document.getElementById('task-modal'); if(modal) modal.style.display = 'none'; }">&times;</button>
            </div>
            <div class="modal-body register-modal-body">
                <form id="task-form" class="register-form" onsubmit="event.preventDefault(); event.stopPropagation(); if(typeof window.saveTask === 'function') { window.saveTask(); } return false;">
                    <div class="form-field form-field-full">
                        <label>„Çø„Ç§„Éà„É´</label>
                        <input type="text" id="task-title" class="form-input">
                    </div>
                    <div class="form-field form-field-full">
                        <label>Ë™¨Êòé</label>
                        <textarea id="task-description" class="form-input" rows="3"></textarea>
                    </div>
                    <div class="form-field form-field-half">
                        <label>ÊúüÈôê</label>
                        <input type="date" id="task-due-date" class="form-input">
                    </div>
                    <div class="form-field form-field-half">
                        <label>ÂÑ™ÂÖàÂ∫¶</label>
                        <select id="task-priority" class="form-input">
                            <option value="low">‰Ωé</option>
                            <option value="medium" selected>‰∏≠</option>
                            <option value="high">È´ò</option>
                        </select>
                    </div>
                    <div class="form-field form-field-full">
                        <label>„Çπ„ÉÜ„Éº„Çø„Çπ</label>
                        <select id="task-status" class="form-input">
                            <option value="pending">Êú™ÂÆå‰∫Ü</option>
                            <option value="in-progress">ÈÄ≤Ë°å‰∏≠</option>
                            <option value="completed">ÂÆå‰∫Ü</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="if(typeof window.closeTaskModal === 'function') { window.closeTaskModal(); } else { const modal = document.getElementById('task-modal'); if(modal) modal.style.display = 'none'; }">„Ç≠„É£„É≥„Çª„É´</button>
                        <button type="button" class="btn-danger" id="task-delete-btn" onclick="if(typeof window.deleteTaskFromModal === 'function') { window.deleteTaskFromModal(); } else { console.error('deleteTaskFromModalÈñ¢Êï∞„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì'); }" style="display: none;">ÂâäÈô§</button>
                        <button type="button" class="btn-primary" id="task-save-btn" onclick="if(typeof window.saveTask === 'function') { window.saveTask(); } else { console.error('saveTaskÈñ¢Êï∞„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì'); alert('saveTaskÈñ¢Êï∞„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„ÄÇ„Éö„Éº„Ç∏„Çí„É™„É≠„Éº„Éâ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ'); }">‰øùÂ≠ò</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- „É°„ÉÉ„Çª„Éº„Ç∏Ë°®Á§∫„Ç®„É™„Ç¢ -->
    <div id="message-area"></div>

    <!-- TodoÈÄöÁü•„Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó -->
    <div id="todo-notification-popup" class="todo-notification-popup" style="display: none;">
        <div class="todo-notification-content">
            <div class="todo-notification-header">
                <h4><i class="fas fa-bell"></i> TodoÈÄöÁü•</h4>
                <button class="todo-notification-close" onclick="closeTodoNotificationPopup()">&times;</button>
            </div>
            <div class="todo-notification-body">
                <div id="todo-notification-title" class="todo-notification-title"></div>
                <div id="todo-notification-message" class="todo-notification-message"></div>
            </div>
        </div>
    </div>

    <!-- ÈÄöÁü•„Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥ -->
    <div id="notification-dropdown" class="notification-dropdown" style="display: none;">
        <div class="notification-dropdown-header">
            <h4>ÈÄöÁü•</h4>
            <button class="notification-close" id="notification-close-btn">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="notification-dropdown-body" id="notification-dropdown-body">
            <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
        </div>
        <div class="notification-dropdown-footer">
            <a href="#" class="notification-view-all">„Åô„Åπ„Å¶Ë°®Á§∫</a>
        </div>
    </div>

    <!-- „Ç´„É¨„É≥„ÉÄ„Éº‰∫àÂÆö„É¢„Éº„ÉÄ„É´ -->
    <div id="calendar-event-modal" class="modal">
        <div class="modal-content calendar-modal-content">
            <div class="modal-header">
                <h3 id="calendar-event-modal-title">‰∫àÂÆö</h3>
                <button class="modal-close" onclick="closeCalendarEventModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="calendar-event-list" class="calendar-event-list"></div>
                <button id="calendar-add-event-btn" class="btn-primary" style="width: 100%; margin-top: 12px;">
                    <i class="fas fa-plus"></i> ‚ú® ‰∫àÂÆö„ÇíËøΩÂä†
                </button>
            </div>
        </div>
    </div>

    <!-- „Ç´„É¨„É≥„ÉÄ„Éº‰∫àÂÆö„Éï„Ç©„Éº„É†„É¢„Éº„ÉÄ„É´ -->
    <div id="calendar-event-form-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="calendar-event-form-title">‰∫àÂÆö„ÇíËøΩÂä†</h3>
                <button class="modal-close" onclick="closeCalendarEventFormModal()">&times;</button>
            </div>
            <div class="modal-body register-modal-body" style="display: flex; gap: 20px; align-items: flex-start;">
                <!-- Â∑¶Ôºö„Åì„ÅÆÊó•„ÅÆ‰∫àÂÆöÔºà„É°„Ç§„É≥Ë°®Á§∫Ôºâ -->
                <div id="calendar-event-form-events-list" class="calendar-event-form-events-list" style="flex: 1.2; min-width: 0; max-height: calc(90vh - 120px); overflow-y: auto; padding: 16px; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-light);">
                    <div class="calendar-event-form-events-header" style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: 12px;">üìÖ „Åì„ÅÆÊó•„ÅÆ‰∫àÂÆö</div>
                    <div id="calendar-event-form-events-content" class="calendar-event-form-events-content">
                        <div class="sidebar-empty" style="font-size: 13px;">‰∫àÂÆö„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                    </div>
                </div>
                
                <!-- Âè≥ÔºöÂÖ•Âäõ„Éï„Ç©„Éº„Éû„ÉÉ„Éà -->
                <div style="flex: 1; min-width: 280px;">
                    <form id="calendar-event-form" class="register-form">
                        <div class="form-field form-field-full">
                            <label>Êó•‰ªò</label>
                            <input type="text" id="calendar-event-date" class="form-input" readonly>
                        </div>
                        <div class="form-field form-field-full">
                            <label>„Çø„Ç§„Éà„É´ <span class="required">*</span></label>
                            <input type="text" id="calendar-event-title" class="form-input" required placeholder="‰∫àÂÆö„ÅÆ„Çø„Ç§„Éà„É´">
                        </div>
                        <div class="form-field form-field-full">
                            <label>ÊôÇÈñì</label>
                            <input type="text" id="calendar-event-time" class="form-input" placeholder="‰æã: 10:00">
                        </div>
                        <div class="form-field form-field-full">
                            <label>Ë©≥Á¥∞</label>
                            <textarea id="calendar-event-description" class="form-input" rows="3" placeholder="‰∫àÂÆö„ÅÆË©≥Á¥∞"></textarea>
                        </div>
                        <div class="form-field form-field-full">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="checkbox" id="calendar-event-notification" style="width: 18px; height: 18px; cursor: pointer;">
                                <span>ÈÄöÁü•„ÇíÊúâÂäπ„Å´„Åô„Çã</span>
                            </label>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn-secondary" onclick="closeCalendarEventFormModal()">„Ç≠„É£„É≥„Çª„É´</button>
                            <button type="submit" class="btn-primary">‰øùÂ≠ò</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Ë®≠ÂÆö„É¢„Éº„ÉÄ„É´ÔºàÁõÆÊ¨°Ôºâ -->
    <div id="settings-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3>ÁÆ°ÁêÜËÄÖË®≠ÂÆö</h3>
                <button class="modal-close" onclick="closeSettingsModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body register-modal-body">
                <div class="settings-menu">
                    <div class="settings-menu-item" onclick="openSettingsPage('permission-settings')">
                        <div class="settings-menu-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="settings-menu-content">
                            <h4>Ê®©ÈôêË®≠ÂÆö</h4>
                            <p>ÈÅãÁî®‰∏≠Â∑•‰∫ãÁï™Âè∑‰∏ÄË¶ß„ÅÆÁ∑®ÈõÜ„ÉªÂâäÈô§Ê®©Èôê„ÇíË®≠ÂÆö</p>
                        </div>
                        <i class="fas fa-chevron-right settings-menu-arrow"></i>
                    </div>
                    <div class="settings-menu-item" onclick="openSettingsPage('user-management')">
                        <div class="settings-menu-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="settings-menu-content">
                            <h4>„É¶„Éº„Ç∂„ÉºÁÆ°ÁêÜ</h4>
                            <p>„Éë„ÇΩ„Ç≥„É≥„É¶„Éº„Ç∂„Éº„Åî„Å®„ÅÆID„Å®„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÁÆ°ÁêÜ</p>
                        </div>
                        <i class="fas fa-chevron-right settings-menu-arrow"></i>
                    </div>
                    <div class="settings-menu-item" onclick="openSettingsPage('company-calendar')">
                        <div class="settings-menu-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="settings-menu-content">
                            <h4>‰ºöÁ§æ„Ç´„É¨„É≥„ÉÄ„ÉºÁÆ°ÁêÜ</h4>
                            <p>ÂúüÊó•‰ª•Â§ñ„ÅÆ‰ºëÊó•„ÇíÁôªÈå≤„ÉªÁÆ°ÁêÜ</p>
                        </div>
                        <i class="fas fa-chevron-right settings-menu-arrow"></i>
                    </div>
                    <div class="settings-menu-item" onclick="openSettingsPage('notification-settings')">
                        <div class="settings-menu-icon">
                            <i class="fas fa-bell"></i>
                        </div>
                        <div class="settings-menu-content">
                            <h4>ÈÄöÁü•Ë®≠ÂÆö</h4>
                            <p>„Ç´„É¨„É≥„ÉÄ„Éº„Ç§„Éô„É≥„Éà„ÅÆÈÄöÁü•Ë®≠ÂÆö</p>
                        </div>
                        <i class="fas fa-chevron-right settings-menu-arrow"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- „É¶„Éº„Ç∂„ÉºÁÆ°ÁêÜ„É¢„Éº„ÉÄ„É´ -->
    <div id="user-management-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <button class="modal-back-btn" onclick="closeSettingsPage('user-management')" title="Êàª„Çã">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h3>„É¶„Éº„Ç∂„ÉºÁÆ°ÁêÜ</h3>
                <button class="modal-close" onclick="closeSettingsPage('user-management')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body register-modal-body">
                <div class="settings-section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h4 class="settings-section-title">
                            <i class="fas fa-users"></i> „É¶„Éº„Ç∂„Éº‰∏ÄË¶ß
                        </h4>
                        <button class="btn-primary btn-small" onclick="openUserFormModal()">
                            <i class="fas fa-plus"></i> „É¶„Éº„Ç∂„Éº„ÇíËøΩÂä†
                        </button>
                    </div>
                    <div id="user-list" class="user-list">
                        <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- „É¶„Éº„Ç∂„ÉºËøΩÂä†„ÉªÁ∑®ÈõÜ„É¢„Éº„ÉÄ„É´ -->
    <div id="user-form-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="user-form-title">„É¶„Éº„Ç∂„Éº„ÇíËøΩÂä†</h3>
                <button class="modal-close" onclick="closeUserFormModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body register-modal-body">
                <form id="user-form" class="register-form" onsubmit="event.preventDefault(); saveUser(); return false;">
                    <div class="form-field form-field-full">
                        <label>PCÂêç / „É¶„Éº„Ç∂„ÉºÂêç <span class="required">*</span></label>
                        <input type="text" id="user-pc-name" class="form-input" required placeholder="‰æã: PC-001 „Åæ„Åü„ÅØ Â±±Áî∞Â§™ÈÉé">
                    </div>
                    <div class="form-field form-field-full">
                        <label>„É≠„Ç∞„Ç§„É≥ID <span class="required">*</span></label>
                        <input type="text" id="user-login-id" class="form-input" required placeholder="„É≠„Ç∞„Ç§„É≥ÊôÇ„Å´‰ΩøÁî®„Åô„ÇãID">
                    </div>
                    <div class="form-field form-field-full">
                        <label>„Éë„Çπ„ÉØ„Éº„Éâ <span id="password-required" class="required">*</span></label>
                        <input type="password" id="user-password" class="form-input" placeholder="„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÖ•ÂäõÔºà4ÊñáÂ≠ó‰ª•‰∏äÔºâ" minlength="4">
                        <div class="field-note" id="password-note">Êñ∞Ë¶èËøΩÂä†ÊôÇ„ÅØÂøÖÈ†à„ÄÅÁ∑®ÈõÜÊôÇ„ÅØÂ§âÊõ¥„Åô„ÇãÂ†¥Âêà„ÅÆ„ÅøÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
                    </div>
                    <div class="form-field form-field-full">
                        <label>„Éë„Çπ„ÉØ„Éº„ÉâÔºàÁ¢∫Ë™çÔºâ <span id="password-confirm-required" class="required">*</span></label>
                        <input type="password" id="user-password-confirm" class="form-input" placeholder="„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÜçÂÖ•Âäõ" minlength="4">
                    </div>
                    <div class="form-field form-field-full">
                        <label>ÈÉ®ÁΩ≤</label>
                        <input type="text" id="user-department" class="form-input" placeholder="ÈÉ®ÁΩ≤Âêç„ÇíÂÖ•ÂäõÔºà‰ªªÊÑèÔºâ">
                        <div class="field-note">ÈÉ®ÁΩ≤Âêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºà‰ªªÊÑèÔºâ</div>
                    </div>
                    <div class="form-field form-field-full">
                        <label>
                            <input type="checkbox" id="user-is-admin" style="width: auto; margin-right: 8px;">
                            ÁÆ°ÁêÜËÄÖÊ®©Èôê
                        </label>
                        <div class="field-note">ÁÆ°ÁêÜËÄÖ„ÅØÂÖ®ÈÉ®ÁΩ≤„ÅÆÊÉÖÂ†±„ÇíÈñ≤Ë¶ß„ÉªÁÆ°ÁêÜ„Åß„Åç„Åæ„Åô</div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeUserFormModal()">„Ç≠„É£„É≥„Çª„É´</button>
                        <button type="submit" class="btn-primary">‰øùÂ≠ò</button>
                    </div>
                    <input type="hidden" id="user-edit-id" value="">
                </form>
            </div>
        </div>
    </div>

    <!-- ‰ºöÁ§æ„Ç´„É¨„É≥„ÉÄ„ÉºÁÆ°ÁêÜ„É¢„Éº„ÉÄ„É´ -->
    <div id="company-calendar-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <button class="modal-back-btn" onclick="closeSettingsPage('company-calendar')" title="Êàª„Çã">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h3>‰ºöÁ§æ„Ç´„É¨„É≥„ÉÄ„ÉºÁÆ°ÁêÜ</h3>
                <button class="modal-close" onclick="closeSettingsPage('company-calendar')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body register-modal-body">
                <div class="settings-section">
                    <p class="settings-section-description">ÂúüÊó•‰ª•Â§ñ„ÅÆ‰ºëÊó•„ÇíÁôªÈå≤„ÉªÁÆ°ÁêÜ„Åó„Åæ„Åô</p>
                    <form id="company-calendar-form">
                        <div class="form-field">
                            <label>Êó•‰ªò <span class="required">*</span></label>
                            <textarea id="company-calendar-dates" rows="3" required placeholder="Êó•‰ªò„Çí„Çπ„Éö„Éº„ÇπÂå∫Âàá„Çä„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ&#10;‰æãÔºö2025/12/25 2025/12/26 2025/12/27" style="font-size: 16px; padding: 16px; line-height: 1.6;"></textarea>
                            <div class="field-note">Ë§áÊï∞„ÅÆÊó•‰ªò„Çí‰∏ÄÂ∫¶„Å´ÁôªÈå≤„Åß„Åç„Åæ„Åô„ÄÇ„Çπ„Éö„Éº„Çπ„ÅßÂå∫Âàá„Å£„Å¶ÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºàYYYY/MM/DDÂΩ¢ÂºèÔºâ</div>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn-primary">‰∏ÄÊã¨ÁôªÈå≤</button>
                        </div>
                    </form>
                    
                    <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--border-light);">
                        <h4 style="margin-bottom: 12px; font-size: 14px; font-weight: 600;">ÁôªÈå≤Ê∏à„Åø„ÅÆ‰ºöÁ§æ„Ç´„É¨„É≥„ÉÄ„ÉºÁ∑®ÈõÜ</h4>
                        <p style="font-size: 12px; color: var(--text-secondary); margin-bottom: 8px;">Êó•‰ªò„Çí„Çπ„Éö„Éº„ÇπÂå∫Âàá„Çä„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÁ∑®ÈõÜÂæå„Äå‰øùÂ≠ò„Äç„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                        <div class="form-field">
                            <textarea id="company-calendar-edit-list" rows="3" placeholder="Êó•‰ªò„Çí„Çπ„Éö„Éº„ÇπÂå∫Âàá„Çä„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ&#10;‰æãÔºö2025/12/25 2025/12/26 2025/12/27" style="font-size: 16px; padding: 16px; line-height: 1.6;"></textarea>
                        </div>
                        <div style="display: flex; gap: 8px; margin-top: 8px;">
                            <button class="btn-primary btn-small" onclick="saveCompanyCalendarEdit()" style="padding: 6px 16px; font-size: 13px;">
                                <i class="fas fa-save"></i> ‰øùÂ≠ò
                            </button>
                            <button class="btn-secondary btn-small" onclick="loadCompanyCalendarEdit()" style="padding: 6px 16px; font-size: 13px;">
                                <i class="fas fa-undo"></i> „É™„Çª„ÉÉ„Éà
                            </button>
                            <button class="btn-secondary btn-small" onclick="exportCompanyCalendarToCSV()" style="padding: 6px 16px; font-size: 13px;">
                                <i class="fas fa-download"></i> CSVÂá∫Âäõ
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÂâäÈô§Á¢∫Ë™ç„É¢„Éº„ÉÄ„É´ -->
    <div id="delete-confirm-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content delete-confirm-modal-content">
            <div class="delete-confirm-header">
                <div class="delete-confirm-icon">‚ö†Ô∏è</div>
                <h3 id="delete-confirm-title">ÂâäÈô§„ÅÆÁ¢∫Ë™ç</h3>
            </div>
            <div class="delete-confirm-body">
                <p id="delete-confirm-message">„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇÊú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü</p>
            </div>
            <div class="delete-confirm-actions">
                <button class="btn-secondary" id="delete-confirm-cancel">„Ç≠„É£„É≥„Çª„É´</button>
                <button class="btn-danger" id="delete-confirm-ok">ÂâäÈô§„Åô„Çã</button>
            </div>
        </div>
    </div>

    <!-- Â∑•‰∫ãÁï™Âè∑ÈÅ©Áî®Á¢∫Ë™ç„É¢„Éº„ÉÄ„É´ -->
    <div id="construct-number-confirm-modal" class="modal-overlay" style="display: none; z-index: 10002 !important;">
        <div class="modal-content delete-confirm-modal-content" style="max-width: 400px;">
            <div class="delete-confirm-header">
                <div class="delete-confirm-icon" style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color: white; font-size: 24px;">‚úì</div>
                <h3>Â∑•‰∫ãÁï™Âè∑„ÅÆÈÅ©Áî®</h3>
            </div>
            <div class="delete-confirm-body">
                <p id="construct-number-confirm-message">Â∑•‰∫ãÁï™Âè∑„Äå<strong id="construct-number-confirm-value"></strong>„Äç„Çí‰ΩøÁî®„Åó„Åæ„Åô„ÅãÔºü</p>
            </div>
            <div class="delete-confirm-actions">
                <button class="btn-secondary" id="construct-number-confirm-cancel">„Ç≠„É£„É≥„Çª„É´</button>
                <button class="btn-primary" id="construct-number-confirm-ok">OK</button>
            </div>
        </div>
    </div>

    <!-- Êé≤Á§∫ÊùøË©≥Á¥∞Ë°®Á§∫„É¢„Éº„ÉÄ„É´ -->
    <div id="bulletin-detail-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="bulletin-detail-title">Êé≤Á§∫Êùø„ÅÆË©≥Á¥∞</h3>
                <button class="modal-close" onclick="closeBulletinDetailModal()">&times;</button>
            </div>
            <div class="modal-body register-modal-body">
                <div class="bulletin-detail-content">
                    <div class="form-field form-field-full">
                        <label>Êó•‰ªò</label>
                        <div id="bulletin-detail-date" class="bulletin-detail-value"></div>
                    </div>
                    <div class="form-field form-field-full">
                        <label>ÂÜÖÂÆπ</label>
                        <div id="bulletin-detail-text" class="bulletin-detail-value" style="white-space: pre-wrap; line-height: 1.6;"></div>
                    </div>
                    <div class="form-field form-field-full" id="bulletin-detail-files-container" style="display: none;">
                        <label>Ê∑ª‰ªò„Éï„Ç°„Ç§„É´</label>
                        <div id="bulletin-detail-files" class="bulletin-detail-files-list"></div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeBulletinDetailModal()">Èñâ„Åò„Çã</button>
                    <button type="button" class="btn-primary" id="bulletin-detail-edit-btn">Á∑®ÈõÜ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Êé≤Á§∫ÊùøÂÖ•Âäõ„É¢„Éº„ÉÄ„É´ -->
    <div id="bulletin-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="bulletin-modal-title">Êé≤Á§∫Êùø„ÇíËøΩÂä†</h3>
                <button class="modal-close" onclick="closeBulletinModal()">&times;</button>
            </div>
            <div class="modal-body register-modal-body">
                <form id="bulletin-form" class="register-form" onsubmit="event.preventDefault(); saveBulletin(); return false;">
                    <div class="form-field form-field-full">
                        <label>Êó•‰ªò</label>
                        <input type="date" id="bulletin-date" class="form-input" required>
                    </div>
                    <div class="form-field form-field-full">
                        <label>ÂÜÖÂÆπ</label>
                        <textarea id="bulletin-text" class="form-input" rows="3" required placeholder="Êé≤Á§∫Êùø„ÅÆÂÜÖÂÆπ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ"></textarea>
                    </div>
                    <div class="form-field form-field-full">
                        <label>Ê∑ª‰ªò„Éï„Ç°„Ç§„É´</label>
                        <input type="file" id="bulletin-file" class="form-input" multiple accept="*/*">
                        <div class="field-note">Ë§áÊï∞„ÅÆ„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åß„Åç„Åæ„ÅôÔºàÊúÄÂ§ß5MB/„Éï„Ç°„Ç§„É´Ôºâ</div>
                        <div id="bulletin-file-list" class="bulletin-file-list"></div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeBulletinModal()">„Ç≠„É£„É≥„Çª„É´</button>
                        <button type="submit" class="btn-primary">‰øùÂ≠ò</button>
                    </div>
                    <input type="hidden" id="bulletin-edit-id" value="">
                </form>
            </div>
        </div>
    </div>

    <!-- „Éï„Ç°„Ç§„É´„Éì„É•„Éº„Ç¢„É¢„Éº„ÉÄ„É´ -->
    <div id="file-viewer-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container" style="max-width: 90%; max-height: 90vh;">
            <div class="modal-header register-modal-header">
                <h3 id="file-viewer-title">„Éï„Ç°„Ç§„É´</h3>
                <button class="modal-close" onclick="closeFileViewerModal()">&times;</button>
            </div>
            <div class="modal-body register-modal-body" style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 400px;">
                <div id="file-viewer-content" style="width: 100%; text-align: center;"></div>
            </div>
            <div style="padding: 16px 24px; border-top: 1px solid var(--border-light); background: var(--bg-secondary); display: flex; justify-content: flex-end; gap: 12px;">
                <button type="button" class="btn-secondary" onclick="closeFileViewerModal()">Èñâ„Åò„Çã</button>
                <button type="button" class="btn-primary" id="file-viewer-download">
                    <i class="fas fa-download"></i> „ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                </button>
            </div>
        </div>
    </div>

    <!-- KPIÂÖ•Âäõ„É¢„Éº„ÉÄ„É´ -->
    <div id="kpi-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="kpi-modal-title">KPIÂÖ•Âäõ</h3>
                <button class="modal-close" onclick="closeKPIModal()">&times;</button>
            </div>
            <div class="modal-body register-modal-body">
                <form id="kpi-form" class="register-form" onsubmit="event.preventDefault(); saveKPI(); return false;">
                    <div class="form-field form-field-full">
                        <label id="kpi-form-label">ÂÄ§</label>
                        <input type="text" id="kpi-form-input" class="form-input" placeholder="Êï∞ÂÄ§„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ">
                        <div class="field-note" id="kpi-form-note">„Éá„Éº„Çø„Éô„Éº„Çπ„Åã„ÇâËá™ÂãïË®àÁÆó„Åï„Çå„Çã‰∫àÂÆö„Åß„Åô„ÄÇÁèæÂú®„ÅØÊâãÂãï„ÅßÂÖ•Âäõ„Åß„Åç„Åæ„Åô„ÄÇ</div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeKPIModal()">„Ç≠„É£„É≥„Çª„É´</button>
                        <button type="submit" class="btn-primary">‰øùÂ≠ò</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- „Ç´„Çπ„Çø„É†„Ç´„É¨„É≥„ÉÄ„Éº„Éî„ÉÉ„Ç´„Éº -->
    <div id="custom-calendar-picker" class="custom-calendar-overlay" style="display: none;">
        <div class="custom-calendar-container">
            <div class="custom-calendar-header">
                <button class="calendar-nav-btn prev-month" id="calendar-prev-month">‚Äπ</button>
                <div class="calendar-month-year">
                    <span id="calendar-display-month">12Êúà</span>
                    <span id="calendar-display-year">2025</span>
                </div>
                <button class="calendar-nav-btn next-month" id="calendar-next-month">‚Ä∫</button>
            </div>
            <div class="custom-calendar-weekdays">
                <div class="weekday">Êó•</div>
                <div class="weekday">Êúà</div>
                <div class="weekday">ÁÅ´</div>
                <div class="weekday">Ê∞¥</div>
                <div class="weekday">Êú®</div>
                <div class="weekday">Èáë</div>
                <div class="weekday">Âúü</div>
            </div>
            <div class="custom-calendar-days" id="calendar-days-grid">
                <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
            </div>
            <div class="custom-calendar-actions">
                <button class="calendar-action-btn clear-btn" id="calendar-clear">„ÇØ„É™„Ç¢</button>
                <button class="calendar-action-btn today-btn" id="calendar-today">‰ªäÊó•</button>
            </div>
        </div>
    </div>
    </div>


    <!-- Â∑•‰∫ãÁï™Âè∑ÂèñÂæó„É¢„Éº„ÉÄ„É´ -->
    <div id="construct-number-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container" style="max-width: 1400px; width: 95%; height: 90vh; max-height: 800px; display: flex; flex-direction: column; margin: 0;">
            <div class="modal-header register-modal-header">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <i class="fas fa-hashtag" style="font-size: 24px;"></i>
                    <h3>Â∑•‰∫ãÁï™Âè∑Êé°Áï™„Ç∑„Çπ„ÉÜ„É†</h3>
                </div>
                <button class="modal-close" onclick="closeConstructNumberModal()">&times;</button>
            </div>
            <div class="modal-body register-modal-body" style="display: flex; gap: 24px; align-items: stretch; padding: 24px; flex: 1; overflow: hidden; height: 100%;">
                <!-- Â∑¶ÂÅ¥ÔºöÂÖ•Âäõ„Éï„Ç©„Éº„É† -->
                <div style="flex: 0 0 420px; max-width: 420px; min-width: 380px; display: flex; flex-direction: column; height: 100%;">
                    <div style="background: linear-gradient(135deg, rgba(74, 144, 226, 0.05) 0%, rgba(74, 144, 226, 0.02) 100%); border-radius: 16px; padding: 20px; border: 2px solid rgba(74, 144, 226, 0.1); height: 100%; display: flex; flex-direction: column;">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px; flex-shrink: 0;">
                            <i class="fas fa-magic" style="color: var(--primary); font-size: 16px;"></i>
                            <h4 style="margin: 0; font-size: 16px; font-weight: 700; color: var(--text-primary);">Êñ∞Ë¶èÂ∑•‰∫ãÁï™Âè∑ÂèñÂæó</h4>
                        </div>
                        <form id="construct-number-form" class="register-form" onsubmit="event.preventDefault(); getConstructNumber(); return false;" style="display: flex; flex-direction: column; flex: 1; min-height: 0;">
                            <div style="flex: 1; display: flex; flex-direction: column; min-height: 0;">
                                <div class="form-field form-field-full" style="flex-shrink: 0;">
                                    <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                    <i class="fas fa-list" style="color: var(--primary);"></i>
                                    Â∑•‰∫ãÁï™Âè∑Âè∞ <span class="required">*</span>
                                </label>
                                    <select id="construct-number-select" name="Â∑•‰∫ãÁï™Âè∑Âè∞" class="form-input" required style="font-size: 14px; padding: 12px;">
                                    <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                                    <option value="1000Áï™Âè∞">1000Áï™Âè∞</option>
                                    <option value="2000Áï™Âè∞">2000Áï™Âè∞</option>
                                    <option value="2900Áï™Âè∞">2900Áï™Âè∞</option>
                                    <option value="3000Áï™Âè∞">3000Áï™Âè∞</option>
                                    <option value="3A00Áï™Âè∞">3A00Áï™Âè∞</option>
                                    <option value="3B00Áï™Âè∞">3B00Áï™Âè∞</option>
                                    <option value="3C00Áï™Âè∞">3C00Áï™Âè∞</option>
                                    <option value="3P00Áï™Âè∞">3P00Áï™Âè∞</option>
                                    <option value="3T00Áï™Âè∞">3T00Áï™Âè∞</option>
                                    <option value="4000Áï™Âè∞">4000Áï™Âè∞</option>
                                    <option value="4A00Áï™Âè∞">4A00Áï™Âè∞</option>
                                    <option value="4B00Áï™Âè∞">4B00Áï™Âè∞</option>
                                    <option value="4C00Áï™Âè∞">4C00Áï™Âè∞</option>
                                    <option value="4P00Áï™Âè∞">4P00Áï™Âè∞</option>
                                    <option value="4T00Áï™Âè∞">4T00Áï™Âè∞</option>
                                    <option value="5000Áï™Âè∞">5000Áï™Âè∞</option>
                                    <option value="5A00Áï™Âè∞">5A00Áï™Âè∞</option>
                                    <option value="5B00Áï™Âè∞">5B00Áï™Âè∞</option>
                                    <option value="5E00Áï™Âè∞">5E00Áï™Âè∞</option>
                                    <option value="6000Áï™Âè∞">6000Áï™Âè∞</option>
                                    <option value="7000Áï™Âè∞">7000Áï™Âè∞</option>
                                    <option value="7P00Áï™Âè∞">7P00Áï™Âè∞</option>
                                    <option value="8000Áï™Âè∞">8000Áï™Âè∞</option>
                                    <option value="8A00Áï™Âè∞">8A00Áï™Âè∞</option>
                                    <option value="8B00Áï™Âè∞">8B00Áï™Âè∞</option>
                                    <option value="8E00Áï™Âè∞">8E00Áï™Âè∞</option>
                                    <option value="9000Áï™Âè∞">9000Áï™Âè∞</option>
                                    <option value="S000Áï™Âè∞">S000Áï™Âè∞</option>
                                    <option value="Z000Áï™Âè∞">Z000Áï™Âè∞</option>
                                    <option value="D000Áï™Âè∞">D000Áï™Âè∞</option>
                                </select>
                            </div>
                                <div class="form-field form-field-full" style="margin-top: 20px; flex-shrink: 0;">
                                    <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                    <i class="fas fa-check-circle" style="color: var(--success);"></i>
                                    ÂèñÂæó„Åï„Çå„ÅüÂ∑•‰∫ãÁï™Âè∑
                                </label>
                                <div style="position: relative;">
                                        <input type="text" id="construct-number-result" class="form-input" readonly style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); font-weight: 700; font-size: 24px; text-align: center; padding: 16px; border: 3px solid var(--success); border-radius: 12px; letter-spacing: 2px; color: #2e7d32; word-break: break-all;">
                                        <div style="position: absolute; top: 8px; right: 12px; color: var(--success); font-size: 18px; opacity: 0.6;">
                                        <i class="fas fa-copy" id="copy-construct-number" style="cursor: pointer;" onclick="copyConstructNumber()" title="„Ç≥„Éî„Éº"></i>
                                    </div>
                                </div>
                                    <div style="margin-top: 8px; font-size: 11px; color: var(--text-secondary); display: flex; align-items: center; gap: 4px; line-height: 1.4;">
                                    <i class="fas fa-info-circle"></i>
                                    <span>„Åì„ÅÆÁï™Âè∑„ÅØËá™ÂãïÁöÑ„Å´‰ΩøÁî®Ê∏à„Åø„Å®„Åó„Å¶Ë®òÈå≤„Åï„Çå„Åæ„Åô</span>
                                </div>
                            </div>
                            </div>
                            <div class="form-actions" style="margin-top: 20px; gap: 10px; display: flex; flex-direction: column; flex-shrink: 0;">
                                <div style="display: flex; gap: 10px;">
                                    <button type="button" class="btn-secondary" onclick="closeConstructNumberModal()" style="flex: 1; min-width: 120px; font-size: 13px; padding: 10px; white-space: nowrap;">
                                    <i class="fas fa-times"></i> „Ç≠„É£„É≥„Çª„É´
                                </button>
                                    <button type="submit" class="btn-primary" style="flex: 1; min-width: 140px; font-size: 13px; padding: 10px; white-space: nowrap;">
                                    <i class="fas fa-magic"></i> Â∑•‰∫ãÁï™Âè∑ÂèñÂæó
                                </button>
                                </div>
                                <button type="button" class="btn-primary" id="apply-construct-number-btn" onclick="applyConstructNumber()" style="display: none; width: 100%; margin-top: 0; font-size: 13px; padding: 10px; white-space: nowrap;">
                                    <i class="fas fa-check-circle"></i> „Åì„ÅÆÁï™Âè∑„Çí‰ΩøÁî®
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Âè≥ÂÅ¥Ôºö‰ΩøÁî®Ê∏à„Åø‰∏ÄË¶ß -->
                <div style="flex: 1; min-width: 350px; display: flex; flex-direction: column; height: 100%;">
                    <div style="background: white; border-radius: 16px; padding: 20px; border: 2px solid var(--border-light); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); height: 100%; display: flex; flex-direction: column;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; flex-wrap: wrap; gap: 8px;">
                            <div style="display: flex; align-items: center; gap: 6px;">
                                <i class="fas fa-history" style="color: var(--primary); font-size: 16px;"></i>
                                <h4 style="margin: 0; font-size: 16px; font-weight: 700; color: var(--text-primary);">‰ΩøÁî®Ê∏à„ÅøÂ∑•‰∫ãÁï™Âè∑‰∏ÄË¶ß</h4>
                            </div>
                            <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                <button type="button" class="btn-secondary btn-small" id="import-csv-btn" onclick="importUsedConstructNumbersCSV()" style="padding: 6px 10px; font-size: 11px; white-space: nowrap;">
                                    <i class="fas fa-file-import"></i> CSV„Ç§„É≥„Éù„Éº„Éà
                                </button>
                                <button type="button" class="btn-secondary btn-small" onclick="exportUsedConstructNumbers()" style="padding: 6px 10px; font-size: 11px; white-space: nowrap;">
                                    <i class="fas fa-file-export"></i> CSVÂá∫Âäõ
                                </button>
                                <button type="button" class="btn-secondary btn-small" id="clear-used-btn" onclick="clearUsedConstructNumbers()" style="padding: 6px 10px; font-size: 11px; display: none; white-space: nowrap;">
                                    <i class="fas fa-trash"></i> ÂÖ®ÂâäÈô§
                                </button>
                            </div>
                        </div>
                        <div style="flex: 1; overflow-y: auto; overflow-x: auto; background: #fafafa; border-radius: 12px; border: 1px solid var(--border-light); min-height: 0;">
                            <table style="width: 100%; border-collapse: collapse; min-width: 280px;">
                                <thead style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); position: sticky; top: 0; z-index: 10;">
                                    <tr>
                                        <th style="padding: 10px 12px; text-align: left; color: white; font-size: 12px; font-weight: 600; border-bottom: 2px solid rgba(255, 255, 255, 0.2); white-space: nowrap;">
                                            <i class="fas fa-hashtag" style="margin-right: 4px;"></i>Â∑•‰∫ãÁï™Âè∑
                                        </th>
                                        <th style="padding: 10px 12px; text-align: center; color: white; font-size: 12px; font-weight: 600; border-bottom: 2px solid rgba(255, 255, 255, 0.2); white-space: nowrap;">
                                            <i class="fas fa-calendar" style="margin-right: 4px;"></i>Êó•‰ªò
                                        </th>
                                        <th id="action-header" style="padding: 10px 12px; text-align: center; color: white; font-size: 12px; font-weight: 600; border-bottom: 2px solid rgba(255, 255, 255, 0.2); width: 70px; display: none;">
                                            <i class="fas fa-cog"></i>Êìç‰Ωú
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="used-construct-numbers-list-inline">
                                    <tr>
                                        <td colspan="3" style="text-align: center; padding: 40px; color: var(--text-tertiary);">
                                            <i class="fas fa-inbox" style="font-size: 32px; margin-bottom: 12px; opacity: 0.3; display: block;"></i>
                                            <span style="font-size: 13px;">‰ΩøÁî®Ê∏à„ÅøÂ∑•‰∫ãÁï™Âè∑„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div style="margin-top: 16px; padding: 10px; background: rgba(74, 144, 226, 0.05); border-radius: 8px; font-size: 11px; color: var(--text-secondary); line-height: 1.4; flex-shrink: 0;">
                            <i class="fas fa-info-circle" style="margin-right: 6px;"></i>
                            <span id="used-count-display">‰ΩøÁî®Ê∏à„Åø: 0‰ª∂</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ‰ΩøÁî®Ê∏à„ÅøÂ∑•‰∫ãÁï™Âè∑‰∏ÄË¶ß„É¢„Éº„ÉÄ„É´ -->
    <div id="used-construct-numbers-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container" style="max-width: 900px;">
            <div class="modal-header register-modal-header">
                <h3>‰ΩøÁî®Ê∏à„ÅøÂ∑•‰∫ãÁï™Âè∑‰∏ÄË¶ß</h3>
                <button class="modal-close" onclick="closeUsedConstructNumbersModal()">&times;</button>
            </div>
            <div class="modal-body register-modal-body">
                <div style="margin-bottom: 16px; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <button type="button" class="btn-secondary btn-small" onclick="clearUsedConstructNumbers()">ÂÖ®ÂâäÈô§</button>
                        <button type="button" class="btn-secondary btn-small" onclick="exportUsedConstructNumbers()" style="margin-left: 8px;">CSVÂá∫Âäõ</button>
                    </div>
                </div>
                <div style="max-height: 500px; overflow-y: auto; border: 1px solid #ddd; border-radius: 4px;">
                    <table class="data-table" style="width: 100%; border-collapse: collapse;">
                        <thead style="background: #f0f0f0; position: sticky; top: 0;">
                            <tr>
                                <th style="padding: 12px; text-align: left; border-bottom: 2px solid #ddd; font-weight: 600;">Â∑•‰∫ãÁï™Âè∑</th>
                                <th style="padding: 12px; text-align: center; border-bottom: 2px solid #ddd; font-weight: 600;">Êó•‰ªò</th>
                            </tr>
                        </thead>
                        <tbody id="used-construct-numbers-list">
                            <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
                        </tbody>
                    </table>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeUsedConstructNumbersModal()">Èñâ„Åò„Çã</button>
                </div>
            </div>
        </div>
    </div>

    <!-- „Çπ„ÇØ„É™„Éó„Éà -->
    <script src="config.js"></script>
    <script src="app.js"></script>
    <script src="task.js"></script>
    <script src="todo.js"></script>
    <script src="form-config.js"></script>
    <script src="custom-calendar.js"></script>
    <script src="drawing-number.js"></script>
    <script src="calendar-notification.js"></script>
</body>
</html>

                                        </div>
                                        
                                        <!-- Êé°Áï™Êó• -->
                                        <div class="form-field form-field-full" style="flex-shrink: 0;">
                                            <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                                Êé°Áï™Êó• <span class="required">*</span>
                                            </label>
                                            <input type="datetime-local" id="saiban-date-input" class="form-input" required style="font-size: 14px; padding: 12px;">
                                        </div>
                                        
                                        <!-- Âü∫Ê∫ñÂõ≥Èù¢Áï™Âè∑ -->
                                        <div class="form-field form-field-full" style="flex-shrink: 0;">
                                            <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                                Âü∫Ê∫ñÂõ≥Èù¢Áï™Âè∑ <span style="color: var(--text-secondary); font-weight: normal;">ÔºàÊú™ÂÖ•ÂäõÊôÇ„ÅØËá™ÂãïÁîüÊàêÔºâ</span>
                                            </label>
                                            <div style="display: flex; gap: 8px;">
                                                <input type="text" id="base-drawing-no-input" class="form-input" 
                                                       placeholder="10Ê°Å‰ª•‰∏ä„ÅÆÂõ≥Èù¢Áï™Âè∑„ÇíÂÖ•ÂäõÔºàÊú™ÂÖ•ÂäõÊôÇ„ÅØËá™ÂãïÁîüÊàêÔºâ" 
                                                       minlength="10"
                                                       style="font-family: monospace; font-size: 16px; letter-spacing: 2px; padding: 12px; flex: 1;">
                                                <button type="button" class="btn-secondary" onclick="generateFirstDrawingNumber()" style="white-space: nowrap; padding: 12px 16px; font-size: 13px;">
                                                    <i class="fas fa-magic"></i> Ëá™ÂãïÁîüÊàê
                                                </button>
                                            </div>
                                            <small style="display: block; margin-top: 4px; font-size: 12px; color: var(--text-secondary);">10Ê°Å‰ª•‰∏ä„ÄÅ6Ê°ÅÁõÆ„Å´„ÄåI„Äç„ÄåO„Äç„ÅØ‰ΩøÁî®‰∏çÂèØ„ÄÇÊú™ÂÖ•ÂäõÊôÇ„ÅØÊ©üÁ®ÆË®òÂè∑„Å®Âõ≥Èù¢Á®ÆÈ°û„Åã„ÇâËá™ÂãïÁîüÊàê„Åï„Çå„Åæ„Åô„ÄÇ</small>
                                        </div>
                                        
                                        <!-- ÂìÅÂêç -->
                                        <div class="form-field form-field-full" style="flex-shrink: 0;">
                                            <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                                ÂìÅÂêç
                                            </label>
                                            <input type="text" id="description-input" class="form-input" 
                                                   placeholder="ÂìÅÂêç„ÇíÂÖ•Âäõ"
                                                   style="font-size: 14px; padding: 12px;">
                                        </div>
                                        
                                        <!-- ÂèñÂæó„Åï„Çå„ÅüÂõ≥Èù¢Áï™Âè∑ -->
                                        <div class="form-field form-field-full" style="margin-top: 20px; flex-shrink: 0;">
                                            <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px; justify-content: center;">
                                                ÂèñÂæó„Åï„Çå„ÅüÂõ≥Èù¢Áï™Âè∑
                                            </label>
                                            <div style="position: relative;">
                                                <input type="text" id="drawing-number-result-page" class="form-input" readonly style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); font-weight: 700; font-size: 20px; text-align: center; padding: 16px; border: 3px solid var(--success); border-radius: 12px; letter-spacing: 2px; color: #2e7d32; word-break: break-all;">
                                                <div style="position: absolute; top: 8px; right: 12px; color: var(--success); font-size: 18px; opacity: 0.6;">
                                                    <i class="fas fa-copy" id="copy-drawing-number-page" style="cursor: pointer;" onclick="copyDrawingNumberPage()" title="„Ç≥„Éî„Éº"></i>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- „Ç®„É©„Éº„É°„ÉÉ„Çª„Éº„Ç∏ -->
                                        <div id="drawing-number-errors-page" style="display: none; background: rgba(255, 107, 107, 0.1); border: 2px solid var(--error); border-radius: 8px; padding: 12px; color: var(--error); font-size: 13px;">
                                            <i class="fas fa-exclamation-triangle" style="margin-right: 8px;"></i>
                                            <span id="drawing-number-error-message-page"></span>
                                        </div>
                                        
                                        <!-- ÊàêÂäü„É°„ÉÉ„Çª„Éº„Ç∏ -->
                                        <div id="drawing-number-success-page" style="display: none; background: rgba(78, 205, 196, 0.1); border: 2px solid var(--success); border-radius: 8px; padding: 12px; color: var(--success); font-size: 13px;">
                                            <i class="fas fa-check-circle" style="margin-right: 8px;"></i>
                                            <span id="drawing-number-success-message-page"></span>
                                        </div>
                                        
                                        <div class="form-actions" style="margin-top: 20px; gap: 10px; display: flex; flex-direction: column; flex-shrink: 0;">
                                            <div style="display: flex; gap: 10px; justify-content: center;">
                                                <button type="submit" class="btn-primary" style="flex: 1; min-width: 140px; max-width: 300px; font-size: 13px; padding: 10px; white-space: nowrap;">
                                                    <i class="fas fa-magic"></i> Âõ≥Èù¢Áï™Âè∑ÂèñÂæó
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        
                        <!-- Âè≥ÂÅ¥ÔºöÂõ≥Èù¢‰∏ÄË¶ß -->
                        <div style="flex: 0 0 400px; max-width: 400px; min-width: 350px; display: flex; flex-direction: column; max-height: 100%;">
                            <div style="background: white; border-radius: 16px; padding: 20px; border: 2px solid var(--border-light); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); display: flex; flex-direction: column; max-height: 100%; overflow: hidden;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; flex-wrap: wrap; gap: 8px; flex-shrink: 0;">
                                    <div style="display: flex; align-items: center; gap: 6px; margin: 0 auto;">
                                        <h4 style="margin: 0; font-size: 16px; font-weight: 700; color: var(--text-primary);">Âõ≥Èù¢‰∏ÄË¶ß</h4>
                                    </div>
                                    <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                        <button type="button" class="btn-secondary btn-small" id="refresh-drawing-list-btn" onclick="loadDrawingList()" style="padding: 6px 10px; font-size: 11px; white-space: nowrap;">
                                            <i class="fas fa-sync-alt"></i> Êõ¥Êñ∞
                                        </button>
                                    </div>
                                </div>
                                <div style="flex: 1; overflow-y: auto; overflow-x: auto; background: #fafafa; border-radius: 12px; border: 1px solid var(--border-light); min-height: 0; max-height: calc(100vh - 300px);">
                                    <table style="width: 100%; border-collapse: collapse; min-width: 300px; margin: 0 auto;">
                                        <thead style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); position: sticky; top: 0; z-index: 10;">
                                            <tr>
                                                <th style="padding: 8px 10px; text-align: center; color: white; font-size: 11px; font-weight: 600; border-bottom: 2px solid rgba(255, 255, 255, 0.2); white-space: nowrap;">
                                                    Âõ≥Èù¢Áï™Âè∑
                                                </th>
                                                <th style="padding: 8px 10px; text-align: center; color: white; font-size: 11px; font-weight: 600; border-bottom: 2px solid rgba(255, 255, 255, 0.2); white-space: nowrap;">
                                                    ÂìÅÂêç
                                                </th>
                                                <th style="padding: 8px 10px; text-align: center; color: white; font-size: 11px; font-weight: 600; border-bottom: 2px solid rgba(255, 255, 255, 0.2); white-space: nowrap;">
                                                    Êé°Áï™Êó•
                                                </th>
                                            </tr>
                                        </thead>
                                        <tbody id="drawing-list-page">
                                            <tr>
                                                <td colspan="3" style="text-align: center; padding: 40px; color: var(--text-tertiary);">
                                                    <i class="fas fa-inbox" style="font-size: 32px; margin-bottom: 12px; opacity: 0.3; display: block;"></i>
                                                    <span style="font-size: 13px;">Âõ≥Èù¢„Éá„Éº„Çø„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</span>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Ê§úÁ¥¢„Éö„Éº„Ç∏ -->
            <div id="search-page" class="page">
                <div class="page-title">
                    <h2>Ê§úÁ¥¢</h2>
                </div>
                <div class="search-buttons">
                    <button class="search-btn">Ë≥ºÂÖ•ÈÉ®ÂìÅ„ÉªÊùêÊñô„ÉªË´∏ÁµåË≤ªÊ§úÁ¥¢</button>
                    <button class="search-btn">Â§ñÊ≥®Âä†Â∑•Ê§úÁ¥¢</button>
                    <button class="search-btn">Ê•≠ËÄÖÂà•Áô∫Ê≥®Ê∏à„ÅøÂ§ñÊ≥®Âä†Â∑•</button>
                    <button class="search-btn">Á¥çÂÖ•‰∫àÂÆö„Ç´„É¨„É≥„ÉÄ„Éº</button>
                    <button class="search-btn">Âä†Â∑•ÈÄ≤ÊçóÊ§úÁ¥¢</button>
                    <button class="search-btn">Ê©üÊ¢∞„ÅßÊ§úÁ¥¢ Âä†Â∑•ÈÄ≤Êçó</button>
                    <button class="search-btn">ÂêçÁß∞„Å´„Çà„ÇãÂéü‰æ°Ê§úÁ¥¢</button>
                    <button class="search-btn">Âá∫Âõ≥„ÉªÊâãÈÖçÁä∂Ê≥Å</button>
                    <button class="search-btn">Âä†Â∑•ÊåØ„ÇäÂàÜ„ÅëÁä∂Ê≥Å</button>
                    <button class="search-btn">Â£≤‰∏äÂπ¥Êúà„ÅßÊ§úÁ¥¢ Â∑•‰∫ã‰∏ÄË¶ß</button>
                </div>
            </div>

            <!-- ÈõÜË®à„Éö„Éº„Ç∏ -->
            <div id="aggregate-page" class="page">
                <div class="page-title">
                    <h2>ÈõÜË®à</h2>
                </div>
                <div class="aggregate-buttons">
                    <button class="aggregate-btn">Â∑•‰∫ãÁï™Âè∑„Å´„Çà„ÇãÂéü‰æ°ÈõÜË®à</button>
                    <button class="aggregate-btn">Âõ≥Èù¢Áï™Âè∑„Å´„Çà„ÇãÂéü‰æ°ÈõÜË®à</button>
                    <button class="aggregate-btn">Ê©üÊ¢∞„Åã„ÇâÂ∑•‰∫ãÁï™Âè∑Ê§úÁ¥¢</button>
                    <button class="aggregate-btn">Â∑•‰∫ãÁï™Âè∑„ÅßÊ§úÁ¥¢„Åô„Çã ÈÉ®ÂìÅ„Åî„Å®„ÅÆÂéü‰æ°ÈõÜË®à</button>
                    <button class="aggregate-btn">Ê•≠ËÄÖÂà•Ë©≤ÂΩìÊúà Á¥çÊúü„Å®Á¥çÂÖ•‰ª∂Êï∞</button>
                </div>
            </div>
        </main>

        <!-- Âè≥„Çµ„Ç§„Éâ„Éê„Éº -->
        <aside class="right-sidebar">
            <div class="right-sidebar-section">
                <h3>Áä∂ÊÖã</h3>
                <div class="status-box pending">
                    <span class="status-box-label">üìã Êú™ÂÆå‰∫Ü</span>
                    <span class="status-box-count" id="status-pending">0</span>
                </div>
                <div class="status-box in-progress">
                    <span class="status-box-label">üîÑ ÈÄ≤Ë°å‰∏≠</span>
                    <span class="status-box-count" id="status-in-progress">0</span>
                </div>
                <div class="status-box completed">
                    <span class="status-box-label">‚úÖ ÂÆå‰∫Ü</span>
                    <span class="status-box-count" id="status-completed">0</span>
                </div>
            </div>
            
            <div class="right-sidebar-section">
                <h3>üìÖ ‰ªäÊó•„ÅÆ‰∫àÂÆö</h3>
                <div id="today-events-list" class="sidebar-events-list">
                    <div class="sidebar-empty">‰∫àÂÆö„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                </div>
                <button id="add-today-event-btn" class="btn-primary btn-small" style="width: 100%; margin-top: 8px;">
                    <i class="fas fa-plus"></i> ‰∫àÂÆö„ÇíËøΩÂä†
                </button>
            </div>
            
            <div class="right-sidebar-section">
                <h3>‚è∞ ÊúüÈôê„ÅÆ„Çø„Çπ„ÇØ</h3>
                <div id="due-tasks-list" class="sidebar-tasks-list">
                    <div class="sidebar-empty">ÊúüÈôê„ÅÆ„Çø„Çπ„ÇØ„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                </div>
            </div>
        </aside>

    </div>

    <!-- „É°„ÉÉ„Çª„Éº„Ç∏Ë°®Á§∫„Ç®„É™„Ç¢ -->
    <div id="message-area"></div>

    <!-- Ë©≥Á¥∞Ë°®Á§∫„É¢„Éº„ÉÄ„É´ -->
    <div id="detail-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="detail-modal-title">Ë©≥Á¥∞</h3>
                <button class="modal-close" id="detail-modal-close">&times;</button>
            </div>
            <div class="modal-body register-modal-body">
                <div id="detail-modal-content" class="form-fields"></div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="close-detail-modal">Èñâ„Åò„Çã</button>
                    <button type="button" class="btn-primary" id="edit-from-detail-modal">Á∑®ÈõÜ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Á¢∫Ë™ç„ÉÄ„Ç§„Ç¢„É≠„Ç∞„É¢„Éº„ÉÄ„É´ -->
    <div id="confirm-dialog-modal" class="modal-overlay" style="display: none; z-index: 50000 !important;">
        <div class="modal-container" style="max-width: 500px; border-radius: 20px; background: white; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); position: relative; z-index: 50001 !important;">
            <div class="modal-body" style="padding: 40px; text-align: center;">
                <div style="font-size: 48px; margin-bottom: 20px;">‚ö†Ô∏è</div>
                <h3 id="confirm-dialog-title" style="font-size: 20px; font-weight: 700; color: var(--text-primary); margin-bottom: 16px; line-height: 1.4;"></h3>
                <p id="confirm-dialog-message" style="font-size: 15px; color: var(--text-secondary); margin-bottom: 32px; line-height: 1.6;"></p>
                <div style="display: flex; gap: 12px; justify-content: center;">
                    <button type="button" id="confirm-dialog-cancel" class="btn-secondary" style="min-width: 120px; padding: 12px 24px; font-size: 15px; font-weight: 600;">„Ç≠„É£„É≥„Çª„É´</button>
                    <button type="button" id="confirm-dialog-ok" class="btn-primary" style="min-width: 120px; padding: 12px 24px; font-size: 15px; font-weight: 600;"></button>
                </div>
            </div>
        </div>
    </div>

    <!-- ÁôªÈå≤„ÉªÁ∑®ÈõÜ„É¢„Éº„ÉÄ„É´Ôºà‰∏≠Â§ÆË°®Á§∫Ôºâ -->
    <div id="register-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="modal-title">Êñ∞Ë¶èÁôªÈå≤</h3>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>
            <div class="modal-body register-modal-body">
                <form id="register-form" class="register-form" novalidate>
                    <div id="register-form-fields" class="form-fields"></div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" id="cancel-register">„Ç≠„É£„É≥„Çª„É´</button>
                        <button type="submit" class="btn-primary">ÁôªÈå≤</button>
                    </div>
                </form>
            </div>
        </div>
    </div>


    <!-- „Çø„Çπ„ÇØÁôªÈå≤„ÉªÁ∑®ÈõÜ„É¢„Éº„ÉÄ„É´ -->
    <div id="task-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="task-modal-title">Êñ∞„Åó„ÅÑ„Çø„Çπ„ÇØ„ÇíËøΩÂä†</h3>
                <button class="modal-close" onclick="if(typeof window.closeTaskModal === 'function') { window.closeTaskModal(); } else { const modal = document.getElementById('task-modal'); if(modal) modal.style.display = 'none'; }">&times;</button>
            </div>
            <div class="modal-body register-modal-body">
                <form id="task-form" class="register-form" onsubmit="event.preventDefault(); event.stopPropagation(); if(typeof window.saveTask === 'function') { window.saveTask(); } return false;">
                    <div class="form-field form-field-full">
                        <label>„Çø„Ç§„Éà„É´</label>
                        <input type="text" id="task-title" class="form-input">
                    </div>
                    <div class="form-field form-field-full">
                        <label>Ë™¨Êòé</label>
                        <textarea id="task-description" class="form-input" rows="3"></textarea>
                    </div>
                    <div class="form-field form-field-half">
                        <label>ÊúüÈôê</label>
                        <input type="date" id="task-due-date" class="form-input">
                    </div>
                    <div class="form-field form-field-half">
                        <label>ÂÑ™ÂÖàÂ∫¶</label>
                        <select id="task-priority" class="form-input">
                            <option value="low">‰Ωé</option>
                            <option value="medium" selected>‰∏≠</option>
                            <option value="high">È´ò</option>
                        </select>
                    </div>
                    <div class="form-field form-field-full">
                        <label>„Çπ„ÉÜ„Éº„Çø„Çπ</label>
                        <select id="task-status" class="form-input">
                            <option value="pending">Êú™ÂÆå‰∫Ü</option>
                            <option value="in-progress">ÈÄ≤Ë°å‰∏≠</option>
                            <option value="completed">ÂÆå‰∫Ü</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="if(typeof window.closeTaskModal === 'function') { window.closeTaskModal(); } else { const modal = document.getElementById('task-modal'); if(modal) modal.style.display = 'none'; }">„Ç≠„É£„É≥„Çª„É´</button>
                        <button type="button" class="btn-danger" id="task-delete-btn" onclick="if(typeof window.deleteTaskFromModal === 'function') { window.deleteTaskFromModal(); } else { console.error('deleteTaskFromModalÈñ¢Êï∞„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì'); }" style="display: none;">ÂâäÈô§</button>
                        <button type="button" class="btn-primary" id="task-save-btn" onclick="if(typeof window.saveTask === 'function') { window.saveTask(); } else { console.error('saveTaskÈñ¢Êï∞„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì'); alert('saveTaskÈñ¢Êï∞„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„ÄÇ„Éö„Éº„Ç∏„Çí„É™„É≠„Éº„Éâ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ'); }">‰øùÂ≠ò</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- „É°„ÉÉ„Çª„Éº„Ç∏Ë°®Á§∫„Ç®„É™„Ç¢ -->
    <div id="message-area"></div>

    <!-- TodoÈÄöÁü•„Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó -->
    <div id="todo-notification-popup" class="todo-notification-popup" style="display: none;">
        <div class="todo-notification-content">
            <div class="todo-notification-header">
                <h4><i class="fas fa-bell"></i> TodoÈÄöÁü•</h4>
                <button class="todo-notification-close" onclick="closeTodoNotificationPopup()">&times;</button>
            </div>
            <div class="todo-notification-body">
                <div id="todo-notification-title" class="todo-notification-title"></div>
                <div id="todo-notification-message" class="todo-notification-message"></div>
            </div>
        </div>
    </div>

    <!-- ÈÄöÁü•„Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥ -->
    <div id="notification-dropdown" class="notification-dropdown" style="display: none;">
        <div class="notification-dropdown-header">
            <h4>ÈÄöÁü•</h4>
            <button class="notification-close" id="notification-close-btn">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="notification-dropdown-body" id="notification-dropdown-body">
            <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
        </div>
        <div class="notification-dropdown-footer">
            <a href="#" class="notification-view-all">„Åô„Åπ„Å¶Ë°®Á§∫</a>
        </div>
    </div>

    <!-- „Ç´„É¨„É≥„ÉÄ„Éº‰∫àÂÆö„É¢„Éº„ÉÄ„É´ -->
    <div id="calendar-event-modal" class="modal">
        <div class="modal-content calendar-modal-content">
            <div class="modal-header">
                <h3 id="calendar-event-modal-title">‰∫àÂÆö</h3>
                <button class="modal-close" onclick="closeCalendarEventModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="calendar-event-list" class="calendar-event-list"></div>
                <button id="calendar-add-event-btn" class="btn-primary" style="width: 100%; margin-top: 12px;">
                    <i class="fas fa-plus"></i> ‚ú® ‰∫àÂÆö„ÇíËøΩÂä†
                </button>
            </div>
        </div>
    </div>

    <!-- „Ç´„É¨„É≥„ÉÄ„Éº‰∫àÂÆö„Éï„Ç©„Éº„É†„É¢„Éº„ÉÄ„É´ -->
    <div id="calendar-event-form-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="calendar-event-form-title">‰∫àÂÆö„ÇíËøΩÂä†</h3>
                <button class="modal-close" onclick="closeCalendarEventFormModal()">&times;</button>
            </div>
            <div class="modal-body register-modal-body" style="display: flex; gap: 20px; align-items: flex-start;">
                <!-- Â∑¶Ôºö„Åì„ÅÆÊó•„ÅÆ‰∫àÂÆöÔºà„É°„Ç§„É≥Ë°®Á§∫Ôºâ -->
                <div id="calendar-event-form-events-list" class="calendar-event-form-events-list" style="flex: 1.2; min-width: 0; max-height: calc(90vh - 120px); overflow-y: auto; padding: 16px; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border-light);">
                    <div class="calendar-event-form-events-header" style="font-size: 16px; font-weight: 600; color: var(--text-primary); margin-bottom: 12px;">üìÖ „Åì„ÅÆÊó•„ÅÆ‰∫àÂÆö</div>
                    <div id="calendar-event-form-events-content" class="calendar-event-form-events-content">
                        <div class="sidebar-empty" style="font-size: 13px;">‰∫àÂÆö„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</div>
                    </div>
                </div>
                
                <!-- Âè≥ÔºöÂÖ•Âäõ„Éï„Ç©„Éº„Éû„ÉÉ„Éà -->
                <div style="flex: 1; min-width: 280px;">
                    <form id="calendar-event-form" class="register-form">
                        <div class="form-field form-field-full">
                            <label>Êó•‰ªò</label>
                            <input type="text" id="calendar-event-date" class="form-input" readonly>
                        </div>
                        <div class="form-field form-field-full">
                            <label>„Çø„Ç§„Éà„É´ <span class="required">*</span></label>
                            <input type="text" id="calendar-event-title" class="form-input" required placeholder="‰∫àÂÆö„ÅÆ„Çø„Ç§„Éà„É´">
                        </div>
                        <div class="form-field form-field-full">
                            <label>ÊôÇÈñì</label>
                            <input type="text" id="calendar-event-time" class="form-input" placeholder="‰æã: 10:00">
                        </div>
                        <div class="form-field form-field-full">
                            <label>Ë©≥Á¥∞</label>
                            <textarea id="calendar-event-description" class="form-input" rows="3" placeholder="‰∫àÂÆö„ÅÆË©≥Á¥∞"></textarea>
                        </div>
                        <div class="form-field form-field-full">
                            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                                <input type="checkbox" id="calendar-event-notification" style="width: 18px; height: 18px; cursor: pointer;">
                                <span>ÈÄöÁü•„ÇíÊúâÂäπ„Å´„Åô„Çã</span>
                            </label>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="btn-secondary" onclick="closeCalendarEventFormModal()">„Ç≠„É£„É≥„Çª„É´</button>
                            <button type="submit" class="btn-primary">‰øùÂ≠ò</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Ë®≠ÂÆö„É¢„Éº„ÉÄ„É´ÔºàÁõÆÊ¨°Ôºâ -->
    <div id="settings-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3>ÁÆ°ÁêÜËÄÖË®≠ÂÆö</h3>
                <button class="modal-close" onclick="closeSettingsModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body register-modal-body">
                <div class="settings-menu">
                    <div class="settings-menu-item" onclick="openSettingsPage('permission-settings')">
                        <div class="settings-menu-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="settings-menu-content">
                            <h4>Ê®©ÈôêË®≠ÂÆö</h4>
                            <p>ÈÅãÁî®‰∏≠Â∑•‰∫ãÁï™Âè∑‰∏ÄË¶ß„ÅÆÁ∑®ÈõÜ„ÉªÂâäÈô§Ê®©Èôê„ÇíË®≠ÂÆö</p>
                        </div>
                        <i class="fas fa-chevron-right settings-menu-arrow"></i>
                    </div>
                    <div class="settings-menu-item" onclick="openSettingsPage('user-management')">
                        <div class="settings-menu-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="settings-menu-content">
                            <h4>„É¶„Éº„Ç∂„ÉºÁÆ°ÁêÜ</h4>
                            <p>„Éë„ÇΩ„Ç≥„É≥„É¶„Éº„Ç∂„Éº„Åî„Å®„ÅÆID„Å®„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÁÆ°ÁêÜ</p>
                        </div>
                        <i class="fas fa-chevron-right settings-menu-arrow"></i>
                    </div>
                    <div class="settings-menu-item" onclick="openSettingsPage('company-calendar')">
                        <div class="settings-menu-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="settings-menu-content">
                            <h4>‰ºöÁ§æ„Ç´„É¨„É≥„ÉÄ„ÉºÁÆ°ÁêÜ</h4>
                            <p>ÂúüÊó•‰ª•Â§ñ„ÅÆ‰ºëÊó•„ÇíÁôªÈå≤„ÉªÁÆ°ÁêÜ</p>
                        </div>
                        <i class="fas fa-chevron-right settings-menu-arrow"></i>
                    </div>
                    <div class="settings-menu-item" onclick="openSettingsPage('notification-settings')">
                        <div class="settings-menu-icon">
                            <i class="fas fa-bell"></i>
                        </div>
                        <div class="settings-menu-content">
                            <h4>ÈÄöÁü•Ë®≠ÂÆö</h4>
                            <p>„Ç´„É¨„É≥„ÉÄ„Éº„Ç§„Éô„É≥„Éà„ÅÆÈÄöÁü•Ë®≠ÂÆö</p>
                        </div>
                        <i class="fas fa-chevron-right settings-menu-arrow"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- „É¶„Éº„Ç∂„ÉºÁÆ°ÁêÜ„É¢„Éº„ÉÄ„É´ -->
    <div id="user-management-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <button class="modal-back-btn" onclick="closeSettingsPage('user-management')" title="Êàª„Çã">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h3>„É¶„Éº„Ç∂„ÉºÁÆ°ÁêÜ</h3>
                <button class="modal-close" onclick="closeSettingsPage('user-management')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body register-modal-body">
                <div class="settings-section">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h4 class="settings-section-title">
                            <i class="fas fa-users"></i> „É¶„Éº„Ç∂„Éº‰∏ÄË¶ß
                        </h4>
                        <button class="btn-primary btn-small" onclick="openUserFormModal()">
                            <i class="fas fa-plus"></i> „É¶„Éº„Ç∂„Éº„ÇíËøΩÂä†
                        </button>
                    </div>
                    <div id="user-list" class="user-list">
                        <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- „É¶„Éº„Ç∂„ÉºËøΩÂä†„ÉªÁ∑®ÈõÜ„É¢„Éº„ÉÄ„É´ -->
    <div id="user-form-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="user-form-title">„É¶„Éº„Ç∂„Éº„ÇíËøΩÂä†</h3>
                <button class="modal-close" onclick="closeUserFormModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body register-modal-body">
                <form id="user-form" class="register-form" onsubmit="event.preventDefault(); saveUser(); return false;">
                    <div class="form-field form-field-full">
                        <label>PCÂêç / „É¶„Éº„Ç∂„ÉºÂêç <span class="required">*</span></label>
                        <input type="text" id="user-pc-name" class="form-input" required placeholder="‰æã: PC-001 „Åæ„Åü„ÅØ Â±±Áî∞Â§™ÈÉé">
                    </div>
                    <div class="form-field form-field-full">
                        <label>„É≠„Ç∞„Ç§„É≥ID <span class="required">*</span></label>
                        <input type="text" id="user-login-id" class="form-input" required placeholder="„É≠„Ç∞„Ç§„É≥ÊôÇ„Å´‰ΩøÁî®„Åô„ÇãID">
                    </div>
                    <div class="form-field form-field-full">
                        <label>„Éë„Çπ„ÉØ„Éº„Éâ <span id="password-required" class="required">*</span></label>
                        <input type="password" id="user-password" class="form-input" placeholder="„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÖ•ÂäõÔºà4ÊñáÂ≠ó‰ª•‰∏äÔºâ" minlength="4">
                        <div class="field-note" id="password-note">Êñ∞Ë¶èËøΩÂä†ÊôÇ„ÅØÂøÖÈ†à„ÄÅÁ∑®ÈõÜÊôÇ„ÅØÂ§âÊõ¥„Åô„ÇãÂ†¥Âêà„ÅÆ„ÅøÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
                    </div>
                    <div class="form-field form-field-full">
                        <label>„Éë„Çπ„ÉØ„Éº„ÉâÔºàÁ¢∫Ë™çÔºâ <span id="password-confirm-required" class="required">*</span></label>
                        <input type="password" id="user-password-confirm" class="form-input" placeholder="„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÜçÂÖ•Âäõ" minlength="4">
                    </div>
                    <div class="form-field form-field-full">
                        <label>ÈÉ®ÁΩ≤</label>
                        <input type="text" id="user-department" class="form-input" placeholder="ÈÉ®ÁΩ≤Âêç„ÇíÂÖ•ÂäõÔºà‰ªªÊÑèÔºâ">
                        <div class="field-note">ÈÉ®ÁΩ≤Âêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºà‰ªªÊÑèÔºâ</div>
                    </div>
                    <div class="form-field form-field-full">
                        <label>
                            <input type="checkbox" id="user-is-admin" style="width: auto; margin-right: 8px;">
                            ÁÆ°ÁêÜËÄÖÊ®©Èôê
                        </label>
                        <div class="field-note">ÁÆ°ÁêÜËÄÖ„ÅØÂÖ®ÈÉ®ÁΩ≤„ÅÆÊÉÖÂ†±„ÇíÈñ≤Ë¶ß„ÉªÁÆ°ÁêÜ„Åß„Åç„Åæ„Åô</div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeUserFormModal()">„Ç≠„É£„É≥„Çª„É´</button>
                        <button type="submit" class="btn-primary">‰øùÂ≠ò</button>
                    </div>
                    <input type="hidden" id="user-edit-id" value="">
                </form>
            </div>
        </div>
    </div>

    <!-- ‰ºöÁ§æ„Ç´„É¨„É≥„ÉÄ„ÉºÁÆ°ÁêÜ„É¢„Éº„ÉÄ„É´ -->
    <div id="company-calendar-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <button class="modal-back-btn" onclick="closeSettingsPage('company-calendar')" title="Êàª„Çã">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <h3>‰ºöÁ§æ„Ç´„É¨„É≥„ÉÄ„ÉºÁÆ°ÁêÜ</h3>
                <button class="modal-close" onclick="closeSettingsPage('company-calendar')">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body register-modal-body">
                <div class="settings-section">
                    <p class="settings-section-description">ÂúüÊó•‰ª•Â§ñ„ÅÆ‰ºëÊó•„ÇíÁôªÈå≤„ÉªÁÆ°ÁêÜ„Åó„Åæ„Åô</p>
                    <form id="company-calendar-form">
                        <div class="form-field">
                            <label>Êó•‰ªò <span class="required">*</span></label>
                            <textarea id="company-calendar-dates" rows="3" required placeholder="Êó•‰ªò„Çí„Çπ„Éö„Éº„ÇπÂå∫Âàá„Çä„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ&#10;‰æãÔºö2025/12/25 2025/12/26 2025/12/27" style="font-size: 16px; padding: 16px; line-height: 1.6;"></textarea>
                            <div class="field-note">Ë§áÊï∞„ÅÆÊó•‰ªò„Çí‰∏ÄÂ∫¶„Å´ÁôªÈå≤„Åß„Åç„Åæ„Åô„ÄÇ„Çπ„Éö„Éº„Çπ„ÅßÂå∫Âàá„Å£„Å¶ÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºàYYYY/MM/DDÂΩ¢ÂºèÔºâ</div>
                        </div>
                        <div class="form-actions">
                            <button type="submit" class="btn-primary">‰∏ÄÊã¨ÁôªÈå≤</button>
                        </div>
                    </form>
                    
                    <div style="margin-top: 24px; padding-top: 24px; border-top: 1px solid var(--border-light);">
                        <h4 style="margin-bottom: 12px; font-size: 14px; font-weight: 600;">ÁôªÈå≤Ê∏à„Åø„ÅÆ‰ºöÁ§æ„Ç´„É¨„É≥„ÉÄ„ÉºÁ∑®ÈõÜ</h4>
                        <p style="font-size: 12px; color: var(--text-secondary); margin-bottom: 8px;">Êó•‰ªò„Çí„Çπ„Éö„Éº„ÇπÂå∫Âàá„Çä„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÁ∑®ÈõÜÂæå„Äå‰øùÂ≠ò„Äç„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
                        <div class="form-field">
                            <textarea id="company-calendar-edit-list" rows="3" placeholder="Êó•‰ªò„Çí„Çπ„Éö„Éº„ÇπÂå∫Âàá„Çä„ÅßÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ&#10;‰æãÔºö2025/12/25 2025/12/26 2025/12/27" style="font-size: 16px; padding: 16px; line-height: 1.6;"></textarea>
                        </div>
                        <div style="display: flex; gap: 8px; margin-top: 8px;">
                            <button class="btn-primary btn-small" onclick="saveCompanyCalendarEdit()" style="padding: 6px 16px; font-size: 13px;">
                                <i class="fas fa-save"></i> ‰øùÂ≠ò
                            </button>
                            <button class="btn-secondary btn-small" onclick="loadCompanyCalendarEdit()" style="padding: 6px 16px; font-size: 13px;">
                                <i class="fas fa-undo"></i> „É™„Çª„ÉÉ„Éà
                            </button>
                            <button class="btn-secondary btn-small" onclick="exportCompanyCalendarToCSV()" style="padding: 6px 16px; font-size: 13px;">
                                <i class="fas fa-download"></i> CSVÂá∫Âäõ
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÂâäÈô§Á¢∫Ë™ç„É¢„Éº„ÉÄ„É´ -->
    <div id="delete-confirm-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content delete-confirm-modal-content">
            <div class="delete-confirm-header">
                <div class="delete-confirm-icon">‚ö†Ô∏è</div>
                <h3 id="delete-confirm-title">ÂâäÈô§„ÅÆÁ¢∫Ë™ç</h3>
            </div>
            <div class="delete-confirm-body">
                <p id="delete-confirm-message">„Åì„ÅÆÊìç‰Ωú„ÅØÂèñ„ÇäÊ∂à„Åõ„Åæ„Åõ„Çì„ÄÇÊú¨ÂΩì„Å´ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü</p>
            </div>
            <div class="delete-confirm-actions">
                <button class="btn-secondary" id="delete-confirm-cancel">„Ç≠„É£„É≥„Çª„É´</button>
                <button class="btn-danger" id="delete-confirm-ok">ÂâäÈô§„Åô„Çã</button>
            </div>
        </div>
    </div>

    <!-- Â∑•‰∫ãÁï™Âè∑ÈÅ©Áî®Á¢∫Ë™ç„É¢„Éº„ÉÄ„É´ -->
    <div id="construct-number-confirm-modal" class="modal-overlay" style="display: none; z-index: 10002 !important;">
        <div class="modal-content delete-confirm-modal-content" style="max-width: 400px;">
            <div class="delete-confirm-header">
                <div class="delete-confirm-icon" style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color: white; font-size: 24px;">‚úì</div>
                <h3>Â∑•‰∫ãÁï™Âè∑„ÅÆÈÅ©Áî®</h3>
            </div>
            <div class="delete-confirm-body">
                <p id="construct-number-confirm-message">Â∑•‰∫ãÁï™Âè∑„Äå<strong id="construct-number-confirm-value"></strong>„Äç„Çí‰ΩøÁî®„Åó„Åæ„Åô„ÅãÔºü</p>
            </div>
            <div class="delete-confirm-actions">
                <button class="btn-secondary" id="construct-number-confirm-cancel">„Ç≠„É£„É≥„Çª„É´</button>
                <button class="btn-primary" id="construct-number-confirm-ok">OK</button>
            </div>
        </div>
    </div>

    <!-- Êé≤Á§∫ÊùøË©≥Á¥∞Ë°®Á§∫„É¢„Éº„ÉÄ„É´ -->
    <div id="bulletin-detail-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="bulletin-detail-title">Êé≤Á§∫Êùø„ÅÆË©≥Á¥∞</h3>
                <button class="modal-close" onclick="closeBulletinDetailModal()">&times;</button>
            </div>
            <div class="modal-body register-modal-body">
                <div class="bulletin-detail-content">
                    <div class="form-field form-field-full">
                        <label>Êó•‰ªò</label>
                        <div id="bulletin-detail-date" class="bulletin-detail-value"></div>
                    </div>
                    <div class="form-field form-field-full">
                        <label>ÂÜÖÂÆπ</label>
                        <div id="bulletin-detail-text" class="bulletin-detail-value" style="white-space: pre-wrap; line-height: 1.6;"></div>
                    </div>
                    <div class="form-field form-field-full" id="bulletin-detail-files-container" style="display: none;">
                        <label>Ê∑ª‰ªò„Éï„Ç°„Ç§„É´</label>
                        <div id="bulletin-detail-files" class="bulletin-detail-files-list"></div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeBulletinDetailModal()">Èñâ„Åò„Çã</button>
                    <button type="button" class="btn-primary" id="bulletin-detail-edit-btn">Á∑®ÈõÜ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Êé≤Á§∫ÊùøÂÖ•Âäõ„É¢„Éº„ÉÄ„É´ -->
    <div id="bulletin-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="bulletin-modal-title">Êé≤Á§∫Êùø„ÇíËøΩÂä†</h3>
                <button class="modal-close" onclick="closeBulletinModal()">&times;</button>
            </div>
            <div class="modal-body register-modal-body">
                <form id="bulletin-form" class="register-form" onsubmit="event.preventDefault(); saveBulletin(); return false;">
                    <div class="form-field form-field-full">
                        <label>Êó•‰ªò</label>
                        <input type="date" id="bulletin-date" class="form-input" required>
                    </div>
                    <div class="form-field form-field-full">
                        <label>ÂÜÖÂÆπ</label>
                        <textarea id="bulletin-text" class="form-input" rows="3" required placeholder="Êé≤Á§∫Êùø„ÅÆÂÜÖÂÆπ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ"></textarea>
                    </div>
                    <div class="form-field form-field-full">
                        <label>Ê∑ª‰ªò„Éï„Ç°„Ç§„É´</label>
                        <input type="file" id="bulletin-file" class="form-input" multiple accept="*/*">
                        <div class="field-note">Ë§áÊï∞„ÅÆ„Éï„Ç°„Ç§„É´„ÇíÈÅ∏Êäû„Åß„Åç„Åæ„ÅôÔºàÊúÄÂ§ß5MB/„Éï„Ç°„Ç§„É´Ôºâ</div>
                        <div id="bulletin-file-list" class="bulletin-file-list"></div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeBulletinModal()">„Ç≠„É£„É≥„Çª„É´</button>
                        <button type="submit" class="btn-primary">‰øùÂ≠ò</button>
                    </div>
                    <input type="hidden" id="bulletin-edit-id" value="">
                </form>
            </div>
        </div>
    </div>

    <!-- „Éï„Ç°„Ç§„É´„Éì„É•„Éº„Ç¢„É¢„Éº„ÉÄ„É´ -->
    <div id="file-viewer-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container" style="max-width: 90%; max-height: 90vh;">
            <div class="modal-header register-modal-header">
                <h3 id="file-viewer-title">„Éï„Ç°„Ç§„É´</h3>
                <button class="modal-close" onclick="closeFileViewerModal()">&times;</button>
            </div>
            <div class="modal-body register-modal-body" style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 400px;">
                <div id="file-viewer-content" style="width: 100%; text-align: center;"></div>
            </div>
            <div style="padding: 16px 24px; border-top: 1px solid var(--border-light); background: var(--bg-secondary); display: flex; justify-content: flex-end; gap: 12px;">
                <button type="button" class="btn-secondary" onclick="closeFileViewerModal()">Èñâ„Åò„Çã</button>
                <button type="button" class="btn-primary" id="file-viewer-download">
                    <i class="fas fa-download"></i> „ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                </button>
            </div>
        </div>
    </div>

    <!-- KPIÂÖ•Âäõ„É¢„Éº„ÉÄ„É´ -->
    <div id="kpi-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container">
            <div class="modal-header register-modal-header">
                <h3 id="kpi-modal-title">KPIÂÖ•Âäõ</h3>
                <button class="modal-close" onclick="closeKPIModal()">&times;</button>
            </div>
            <div class="modal-body register-modal-body">
                <form id="kpi-form" class="register-form" onsubmit="event.preventDefault(); saveKPI(); return false;">
                    <div class="form-field form-field-full">
                        <label id="kpi-form-label">ÂÄ§</label>
                        <input type="text" id="kpi-form-input" class="form-input" placeholder="Êï∞ÂÄ§„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ">
                        <div class="field-note" id="kpi-form-note">„Éá„Éº„Çø„Éô„Éº„Çπ„Åã„ÇâËá™ÂãïË®àÁÆó„Åï„Çå„Çã‰∫àÂÆö„Åß„Åô„ÄÇÁèæÂú®„ÅØÊâãÂãï„ÅßÂÖ•Âäõ„Åß„Åç„Åæ„Åô„ÄÇ</div>
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn-secondary" onclick="closeKPIModal()">„Ç≠„É£„É≥„Çª„É´</button>
                        <button type="submit" class="btn-primary">‰øùÂ≠ò</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- „Ç´„Çπ„Çø„É†„Ç´„É¨„É≥„ÉÄ„Éº„Éî„ÉÉ„Ç´„Éº -->
    <div id="custom-calendar-picker" class="custom-calendar-overlay" style="display: none;">
        <div class="custom-calendar-container">
            <div class="custom-calendar-header">
                <button class="calendar-nav-btn prev-month" id="calendar-prev-month">‚Äπ</button>
                <div class="calendar-month-year">
                    <span id="calendar-display-month">12Êúà</span>
                    <span id="calendar-display-year">2025</span>
                </div>
                <button class="calendar-nav-btn next-month" id="calendar-next-month">‚Ä∫</button>
            </div>
            <div class="custom-calendar-weekdays">
                <div class="weekday">Êó•</div>
                <div class="weekday">Êúà</div>
                <div class="weekday">ÁÅ´</div>
                <div class="weekday">Ê∞¥</div>
                <div class="weekday">Êú®</div>
                <div class="weekday">Èáë</div>
                <div class="weekday">Âúü</div>
            </div>
            <div class="custom-calendar-days" id="calendar-days-grid">
                <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
            </div>
            <div class="custom-calendar-actions">
                <button class="calendar-action-btn clear-btn" id="calendar-clear">„ÇØ„É™„Ç¢</button>
                <button class="calendar-action-btn today-btn" id="calendar-today">‰ªäÊó•</button>
            </div>
        </div>
    </div>
    </div>


    <!-- Â∑•‰∫ãÁï™Âè∑ÂèñÂæó„É¢„Éº„ÉÄ„É´ -->
    <div id="construct-number-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container" style="max-width: 1400px; width: 95%; height: 90vh; max-height: 800px; display: flex; flex-direction: column; margin: 0;">
            <div class="modal-header register-modal-header">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <i class="fas fa-hashtag" style="font-size: 24px;"></i>
                    <h3>Â∑•‰∫ãÁï™Âè∑Êé°Áï™„Ç∑„Çπ„ÉÜ„É†</h3>
                </div>
                <button class="modal-close" onclick="closeConstructNumberModal()">&times;</button>
            </div>
            <div class="modal-body register-modal-body" style="display: flex; gap: 24px; align-items: stretch; padding: 24px; flex: 1; overflow: hidden; height: 100%;">
                <!-- Â∑¶ÂÅ¥ÔºöÂÖ•Âäõ„Éï„Ç©„Éº„É† -->
                <div style="flex: 0 0 420px; max-width: 420px; min-width: 380px; display: flex; flex-direction: column; height: 100%;">
                    <div style="background: linear-gradient(135deg, rgba(74, 144, 226, 0.05) 0%, rgba(74, 144, 226, 0.02) 100%); border-radius: 16px; padding: 20px; border: 2px solid rgba(74, 144, 226, 0.1); height: 100%; display: flex; flex-direction: column;">
                        <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 16px; flex-shrink: 0;">
                            <i class="fas fa-magic" style="color: var(--primary); font-size: 16px;"></i>
                            <h4 style="margin: 0; font-size: 16px; font-weight: 700; color: var(--text-primary);">Êñ∞Ë¶èÂ∑•‰∫ãÁï™Âè∑ÂèñÂæó</h4>
                        </div>
                        <form id="construct-number-form" class="register-form" onsubmit="event.preventDefault(); getConstructNumber(); return false;" style="display: flex; flex-direction: column; flex: 1; min-height: 0;">
                            <div style="flex: 1; display: flex; flex-direction: column; min-height: 0;">
                                <div class="form-field form-field-full" style="flex-shrink: 0;">
                                    <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                    <i class="fas fa-list" style="color: var(--primary);"></i>
                                    Â∑•‰∫ãÁï™Âè∑Âè∞ <span class="required">*</span>
                                </label>
                                    <select id="construct-number-select" name="Â∑•‰∫ãÁï™Âè∑Âè∞" class="form-input" required style="font-size: 14px; padding: 12px;">
                                    <option value="">ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                                    <option value="1000Áï™Âè∞">1000Áï™Âè∞</option>
                                    <option value="2000Áï™Âè∞">2000Áï™Âè∞</option>
                                    <option value="2900Áï™Âè∞">2900Áï™Âè∞</option>
                                    <option value="3000Áï™Âè∞">3000Áï™Âè∞</option>
                                    <option value="3A00Áï™Âè∞">3A00Áï™Âè∞</option>
                                    <option value="3B00Áï™Âè∞">3B00Áï™Âè∞</option>
                                    <option value="3C00Áï™Âè∞">3C00Áï™Âè∞</option>
                                    <option value="3P00Áï™Âè∞">3P00Áï™Âè∞</option>
                                    <option value="3T00Áï™Âè∞">3T00Áï™Âè∞</option>
                                    <option value="4000Áï™Âè∞">4000Áï™Âè∞</option>
                                    <option value="4A00Áï™Âè∞">4A00Áï™Âè∞</option>
                                    <option value="4B00Áï™Âè∞">4B00Áï™Âè∞</option>
                                    <option value="4C00Áï™Âè∞">4C00Áï™Âè∞</option>
                                    <option value="4P00Áï™Âè∞">4P00Áï™Âè∞</option>
                                    <option value="4T00Áï™Âè∞">4T00Áï™Âè∞</option>
                                    <option value="5000Áï™Âè∞">5000Áï™Âè∞</option>
                                    <option value="5A00Áï™Âè∞">5A00Áï™Âè∞</option>
                                    <option value="5B00Áï™Âè∞">5B00Áï™Âè∞</option>
                                    <option value="5E00Áï™Âè∞">5E00Áï™Âè∞</option>
                                    <option value="6000Áï™Âè∞">6000Áï™Âè∞</option>
                                    <option value="7000Áï™Âè∞">7000Áï™Âè∞</option>
                                    <option value="7P00Áï™Âè∞">7P00Áï™Âè∞</option>
                                    <option value="8000Áï™Âè∞">8000Áï™Âè∞</option>
                                    <option value="8A00Áï™Âè∞">8A00Áï™Âè∞</option>
                                    <option value="8B00Áï™Âè∞">8B00Áï™Âè∞</option>
                                    <option value="8E00Áï™Âè∞">8E00Áï™Âè∞</option>
                                    <option value="9000Áï™Âè∞">9000Áï™Âè∞</option>
                                    <option value="S000Áï™Âè∞">S000Áï™Âè∞</option>
                                    <option value="Z000Áï™Âè∞">Z000Áï™Âè∞</option>
                                    <option value="D000Áï™Âè∞">D000Áï™Âè∞</option>
                                </select>
                            </div>
                                <div class="form-field form-field-full" style="margin-top: 20px; flex-shrink: 0;">
                                    <label style="display: flex; align-items: center; gap: 6px; font-weight: 600; margin-bottom: 8px; font-size: 14px;">
                                    <i class="fas fa-check-circle" style="color: var(--success);"></i>
                                    ÂèñÂæó„Åï„Çå„ÅüÂ∑•‰∫ãÁï™Âè∑
                                </label>
                                <div style="position: relative;">
                                        <input type="text" id="construct-number-result" class="form-input" readonly style="background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); font-weight: 700; font-size: 24px; text-align: center; padding: 16px; border: 3px solid var(--success); border-radius: 12px; letter-spacing: 2px; color: #2e7d32; word-break: break-all;">
                                        <div style="position: absolute; top: 8px; right: 12px; color: var(--success); font-size: 18px; opacity: 0.6;">
                                        <i class="fas fa-copy" id="copy-construct-number" style="cursor: pointer;" onclick="copyConstructNumber()" title="„Ç≥„Éî„Éº"></i>
                                    </div>
                                </div>
                                    <div style="margin-top: 8px; font-size: 11px; color: var(--text-secondary); display: flex; align-items: center; gap: 4px; line-height: 1.4;">
                                    <i class="fas fa-info-circle"></i>
                                    <span>„Åì„ÅÆÁï™Âè∑„ÅØËá™ÂãïÁöÑ„Å´‰ΩøÁî®Ê∏à„Åø„Å®„Åó„Å¶Ë®òÈå≤„Åï„Çå„Åæ„Åô</span>
                                </div>
                            </div>
                            </div>
                            <div class="form-actions" style="margin-top: 20px; gap: 10px; display: flex; flex-direction: column; flex-shrink: 0;">
                                <div style="display: flex; gap: 10px;">
                                    <button type="button" class="btn-secondary" onclick="closeConstructNumberModal()" style="flex: 1; min-width: 120px; font-size: 13px; padding: 10px; white-space: nowrap;">
                                    <i class="fas fa-times"></i> „Ç≠„É£„É≥„Çª„É´
                                </button>
                                    <button type="submit" class="btn-primary" style="flex: 1; min-width: 140px; font-size: 13px; padding: 10px; white-space: nowrap;">
                                    <i class="fas fa-magic"></i> Â∑•‰∫ãÁï™Âè∑ÂèñÂæó
                                </button>
                                </div>
                                <button type="button" class="btn-primary" id="apply-construct-number-btn" onclick="applyConstructNumber()" style="display: none; width: 100%; margin-top: 0; font-size: 13px; padding: 10px; white-space: nowrap;">
                                    <i class="fas fa-check-circle"></i> „Åì„ÅÆÁï™Âè∑„Çí‰ΩøÁî®
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Âè≥ÂÅ¥Ôºö‰ΩøÁî®Ê∏à„Åø‰∏ÄË¶ß -->
                <div style="flex: 1; min-width: 350px; display: flex; flex-direction: column; height: 100%;">
                    <div style="background: white; border-radius: 16px; padding: 20px; border: 2px solid var(--border-light); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); height: 100%; display: flex; flex-direction: column;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; flex-wrap: wrap; gap: 8px;">
                            <div style="display: flex; align-items: center; gap: 6px;">
                                <i class="fas fa-history" style="color: var(--primary); font-size: 16px;"></i>
                                <h4 style="margin: 0; font-size: 16px; font-weight: 700; color: var(--text-primary);">‰ΩøÁî®Ê∏à„ÅøÂ∑•‰∫ãÁï™Âè∑‰∏ÄË¶ß</h4>
                            </div>
                            <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                <button type="button" class="btn-secondary btn-small" id="import-csv-btn" onclick="importUsedConstructNumbersCSV()" style="padding: 6px 10px; font-size: 11px; white-space: nowrap;">
                                    <i class="fas fa-file-import"></i> CSV„Ç§„É≥„Éù„Éº„Éà
                                </button>
                                <button type="button" class="btn-secondary btn-small" onclick="exportUsedConstructNumbers()" style="padding: 6px 10px; font-size: 11px; white-space: nowrap;">
                                    <i class="fas fa-file-export"></i> CSVÂá∫Âäõ
                                </button>
                                <button type="button" class="btn-secondary btn-small" id="clear-used-btn" onclick="clearUsedConstructNumbers()" style="padding: 6px 10px; font-size: 11px; display: none; white-space: nowrap;">
                                    <i class="fas fa-trash"></i> ÂÖ®ÂâäÈô§
                                </button>
                            </div>
                        </div>
                        <div style="flex: 1; overflow-y: auto; overflow-x: auto; background: #fafafa; border-radius: 12px; border: 1px solid var(--border-light); min-height: 0;">
                            <table style="width: 100%; border-collapse: collapse; min-width: 280px;">
                                <thead style="background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); position: sticky; top: 0; z-index: 10;">
                                    <tr>
                                        <th style="padding: 10px 12px; text-align: left; color: white; font-size: 12px; font-weight: 600; border-bottom: 2px solid rgba(255, 255, 255, 0.2); white-space: nowrap;">
                                            <i class="fas fa-hashtag" style="margin-right: 4px;"></i>Â∑•‰∫ãÁï™Âè∑
                                        </th>
                                        <th style="padding: 10px 12px; text-align: center; color: white; font-size: 12px; font-weight: 600; border-bottom: 2px solid rgba(255, 255, 255, 0.2); white-space: nowrap;">
                                            <i class="fas fa-calendar" style="margin-right: 4px;"></i>Êó•‰ªò
                                        </th>
                                        <th id="action-header" style="padding: 10px 12px; text-align: center; color: white; font-size: 12px; font-weight: 600; border-bottom: 2px solid rgba(255, 255, 255, 0.2); width: 70px; display: none;">
                                            <i class="fas fa-cog"></i>Êìç‰Ωú
                                        </th>
                                    </tr>
                                </thead>
                                <tbody id="used-construct-numbers-list-inline">
                                    <tr>
                                        <td colspan="3" style="text-align: center; padding: 40px; color: var(--text-tertiary);">
                                            <i class="fas fa-inbox" style="font-size: 32px; margin-bottom: 12px; opacity: 0.3; display: block;"></i>
                                            <span style="font-size: 13px;">‰ΩøÁî®Ê∏à„ÅøÂ∑•‰∫ãÁï™Âè∑„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì</span>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div style="margin-top: 16px; padding: 10px; background: rgba(74, 144, 226, 0.05); border-radius: 8px; font-size: 11px; color: var(--text-secondary); line-height: 1.4; flex-shrink: 0;">
                            <i class="fas fa-info-circle" style="margin-right: 6px;"></i>
                            <span id="used-count-display">‰ΩøÁî®Ê∏à„Åø: 0‰ª∂</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ‰ΩøÁî®Ê∏à„ÅøÂ∑•‰∫ãÁï™Âè∑‰∏ÄË¶ß„É¢„Éº„ÉÄ„É´ -->
    <div id="used-construct-numbers-modal" class="modal-overlay" style="display: none;">
        <div class="modal-container register-modal-container" style="max-width: 900px;">
            <div class="modal-header register-modal-header">
                <h3>‰ΩøÁî®Ê∏à„ÅøÂ∑•‰∫ãÁï™Âè∑‰∏ÄË¶ß</h3>
                <button class="modal-close" onclick="closeUsedConstructNumbersModal()">&times;</button>
            </div>
            <div class="modal-body register-modal-body">
                <div style="margin-bottom: 16px; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <button type="button" class="btn-secondary btn-small" onclick="clearUsedConstructNumbers()">ÂÖ®ÂâäÈô§</button>
                        <button type="button" class="btn-secondary btn-small" onclick="exportUsedConstructNumbers()" style="margin-left: 8px;">CSVÂá∫Âäõ</button>
                    </div>
                </div>
                <div style="max-height: 500px; overflow-y: auto; border: 1px solid #ddd; border-radius: 4px;">
                    <table class="data-table" style="width: 100%; border-collapse: collapse;">
                        <thead style="background: #f0f0f0; position: sticky; top: 0;">
                            <tr>
                                <th style="padding: 12px; text-align: left; border-bottom: 2px solid #ddd; font-weight: 600;">Â∑•‰∫ãÁï™Âè∑</th>
                                <th style="padding: 12px; text-align: center; border-bottom: 2px solid #ddd; font-weight: 600;">Êó•‰ªò</th>
                            </tr>
                        </thead>
                        <tbody id="used-construct-numbers-list">
                            <!-- ÂãïÁöÑ„Å´ÁîüÊàê„Åï„Çå„Åæ„Åô -->
                        </tbody>
                    </table>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeUsedConstructNumbersModal()">Èñâ„Åò„Çã</button>
                </div>
            </div>
        </div>
    </div>
</body>
</html>
